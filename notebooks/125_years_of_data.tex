%% This file was auto-generated by IPython.
%% Conversion from the original notebook file:
%% 125_years_of_data.ipynb
%%
\documentclass[11pt,english]{article}

%% This is the automatic preamble used by IPython.  Note that it does *not*
%% include a documentclass declaration, that is added at runtime to the overall
%% document.
\documentclass[conference,a4paper]{IEEEtran}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{ucs}
\usepackage[utf8x]{inputenc}


\usepackage[pdftitle={125 years of data},pdftex,urlcolor=blue,colorlinks=true,linkcolor=black]{hyperref}
\usepackage[T1]{fontenc}
\usepackage[bitstream-charter]{mathdesign}

\usepackage{cite}
\usepackage{pgf}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{datatool}
\usepackage{dataplot}
\usepackage{xcolor}
\usetikzlibrary{calc,through,decorations.pathmorphing}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{decorations.text}
\usetikzlibrary{trees}
\usetikzlibrary{fit}
\usetikzlibrary{backgrounds}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{shadows}
\usetikzlibrary{calendar}
\usepackage[cmex10]{amsmath}
\usepackage{array}
\usepackage{ctable}
\usepackage{dcolumn}
\usepackage{mdwmath}
\usepackage{mdwtab}
\usepackage{setspace}
\usepackage{fancyhdr}
\usepackage{electComp}
\usepackage{amsmath}
\usepackage{url}

%Get rid of the paragraph indents...
\setlength{\parindent}{0mm}
\setlength{\textheight}{260mm}
% needed for markdown enumerations to work
\usepackage{enumerate}

% Slightly bigger margins than the latex defaults
%\usepackage{geometry}
%\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=2.5cm,rmargin=2.5cm}

% Define a few colors for use in code, links and cell shading
\usepackage{color}
\definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
\definecolor{darkorange}{rgb}{.71,0.21,0.01}
\definecolor{darkgreen}{rgb}{.12,.54,.11}
\definecolor{myteal}{rgb}{.26, .44, .56}
\definecolor{gray}{gray}{0.45}
\definecolor{lightgray}{gray}{.95}
\definecolor{mediumgray}{gray}{.8}
\definecolor{inputbackground}{rgb}{.95, .95, .85}
\definecolor{outputbackground}{rgb}{.95, .95, .95}
\definecolor{traceback}{rgb}{1, .95, .95}

% Framed environments for code cells (inputs, outputs, errors, ...).  The
% various uses of \unskip (or not) at the end were fine-tuned by hand, so don't
% randomly change them unless you're sure of the effect it will have.
\usepackage{framed}

% remove extraneous vertical space in boxes
\setlength\fboxsep{0pt}

% codecell is the whole input+output set of blocks that a Code cell can
% generate.

% TODO: unfortunately, it seems that using a framed codecell environment breaks
% the ability of the frames inside of it to be broken across pages.  This
% causes at least the problem of having lots of empty space at the bottom of
% pages as new frames are moved to the next page, and if a single frame is too
% long to fit on a page, will completely stop latex from compiling the
% document.  So unless we figure out a solution to this, we'll have to instead
% leave the codecell env. as empty.  I'm keeping the original codecell
% definition here (a thin vertical bar) for reference, in case we find a
% solution to the page break issue.

%% \newenvironment{codecell}{%
%%     \def\FrameCommand{\color{mediumgray} \vrule width 1pt \hspace{5pt}}%
%%    \MakeFramed{\vspace{-0.5em}}}
%%  {\unskip\endMakeFramed}

% For now, make this a no-op...
\newenvironment{codecell}{}

 \newenvironment{codeinput}{%
   \def\FrameCommand{\colorbox{inputbackground}}%
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\unskip\endMakeFramed}

\newenvironment{codeoutput}{%
   \def\FrameCommand{\colorbox{outputbackground}}%
   \vspace{-1.4em}
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\unskip\medskip\endMakeFramed}

\newenvironment{traceback}{%
   \def\FrameCommand{\colorbox{traceback}}%
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\endMakeFramed}

% Use and configure listings package for nicely formatted code
\usepackage{listingsutf8}
\lstset{
  language=python,
  inputencoding=utf8x,
  extendedchars=\true,
  aboveskip=\smallskipamount,
  belowskip=\smallskipamount,
  xleftmargin=2mm,
  breaklines=true,
  basicstyle=\small \ttfamily,
  showstringspaces=false,
  keywordstyle=\color{blue}\bfseries,
  commentstyle=\color{myteal},
  stringstyle=\color{darkgreen},
  identifierstyle=\color{darkorange},
  columns=fullflexible,  % tighter character kerning, like verb
}

% The hyperref package gives us a pdf with properly built
% internal navigation ('pdf bookmarks' for the table of contents,
% internal cross-reference links, web links for URLs, etc.)
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,  % so long urls are correctly broken across lines
  colorlinks=true,
  urlcolor=blue,
  linkcolor=darkorange,
  citecolor=darkgreen,
  }

% hardcode size of all verbatim environments to be a bit smaller
\makeatletter 
\g@addto@macro\@verbatim\small\topsep=0.5em\partopsep=0pt
\makeatother 

% Prevent overflowing lines due to urls and other hard-to-break entities.
\sloppy






\begin{document}

% paper title
% can use linebreaks \\ within to get better formatting as desired
\title{125 years of data \\ \vspace{5mm} \large{EEA Conference 2013} \\ \normalsize{SKYCITY Convention Centre, Auckland, New Zealand, 19--21 June 2012}}

%Paper by: Friday 19th April, 2013;
% author names and affiliations
% use a multiple column layout for up to three different
% affiliations
%\author{\IEEEauthorblockN{\Large David Hume, \normalsize BE, PhD, MIEEE, MIET}
%\IEEEauthorblockA{Electricity Authority \\
%\emph{Email: david.hume@ea.govt.nz}}}
\author{\IEEEauthorblockN{David Hume}
\IEEEauthorblockA{Electricity Authority, Level 7, 2 Hunter Street, Wellington \\  
Email: david.hume@ea.govt.nz} } 

% make the title area

\maketitle
\fancyfoot[CE,CO]{\footnotesize \thepage\ of \pageref{LastPage}}
\fancyfoot[LE,LO]{\footnotesize 125 years of data}

\IEEEpeerreviewmaketitle
\begin{tikzpicture}
\draw (50,0) node[top color=blue!10,text width=8.6cm,text justified, bottom color=blue!10]
{
\begin{abstract}
\setstretch{0.99}
\normalfont\small

The power industry today generates vast volumes of data. Much of this data is hidden in complex relational databases and data warehouses such as those used in the Electricity Authority's Centralised Data Set (CDS), and Data Warehouse. Other data is available online but more often than not can be difficult to interpret, prepare, and analyse.

This paper visually explores a small and interesting selection of this industry data; from the growth in total New Zealand generation nameplate capacity (with beginnings at Reefton in 1888), to the electricity consumed every six seconds at the author's home in Wellington. From real-time spot market price data, to past historical transmission outage data, to the movements in future planned generation outage data.

The paper also discusses modern techniques utilising open source software to help aid the preparation and presentation of data.


\end{abstract}

%\begin{keywords}

%\end{keywords}

};

\end{tikzpicture}

\begin{Introduction}
This paper provides results and analysis from an erratic smorgasbord of both well known, and lesser known data-series within the NZ electrical power system/market.  Most of these data series are either openly available on-line, or through the published Centralised Data Set (CDS).  
As part of the Market Performance team at the Electricity Authority, the author has been fortunate enough to be involved with some of the data `munging' (or data wrangling) required to get some of these data sets to ``conform'' before analysis and then visualisation.  The process often leads to further questions like, why? and how?, leading to yet further analysis and visualisation!

In line with the theme of the conference (but out by two years...) the paper begins with a very small data set representing the growth of generation name-plate capacity in New Zealand.  This series begins, not 125 years ago at Reefton, but 127 years ago at a private gold field near Queenstown.

Jumping ahead to the modern day, Section 2 looks at the electrical demand of the authors home in Wellington.  This data is recorded once every 6 seconds to a database running on a Raspberry Pi computer.  This dataset represents, perhaps, a small part of what future "Big Data" may look like on the residential demand side of the industry.  

Section 3, explores a small sample set of energy price data including real-time 5 minute prices and briefly illustrates the differences seen in the difference price series used within the market.  

Using data openly published on the Centralised Data Set, Section 4 explores, and attempts to identify any trends present in forced transmission outage data supplied by Transpower.

Section 5 briefly explores the Planned Outage Co-Ordination Process (or POCP).  This database, run by the System Operator is used by Transpower (as asset owner), 
and most Generators to publicise planned outages.  Finally, Section 6 provides a brief over-view of the open source software used by the author for all analysis and presentation used in this paper.

\section{Growth in New Zealand generation capacity since 1886}

%Interesting links 

%<p>Bullendale links
%http://www.doc.govt.nz/Documents/science-and-technical/sap237.pdf
%http://www.doc.govt.nz/Documents/science-and-technical/sap237b.pdf
%http://www.doc.govt.nz/Documents/science-and-technical/sap237c.pdf
%Reefton links
%http://www.reefcottage.co.nz/41_history.htm   
%http://www.reeftongold.co.nz/morning-heritage-tours/electric-light
%http://www.TeAra.govt.nz/en/gold-and-gold-mining/12/2
%From the Inangahua Herald, 6 August 1888, p. 2

%A second public trail of the electric light system was made on Saturday evening last in Broadway. The night was fortunately very favorable for the display, and an immense crowd of people gathered in the street to witness the %exhibition, and when, shortly before 8 p.m., the powerful light of the arc-lamp burst forth, like a flash of a mighty meteor, a murmer of admiration rose from the spectators, and there was an immediate skampering of feet towards %the sceen of the display. As on the former occasion, the lkight throbbed a good deal, but at its maximum brilliancy illuminated the town over a very wide area, with its cold, cheeless, phosphorescent rays. The illumination %reached far up'on the mountains round the town, and gave a very sepulchral appearance to the hilll-sides, the treess and stumps standing out in the strange pallid light, like so may tombstones. But if the arc-light was an %attraction outside, the interiori of the Oddfello's Hall was infeitely more so. Rows of lamps were sespended fownt he building, encased in a variety of fantastically shaped shades of different colours, and thye whole scene was %one of strickin splendor. It was indeed a "Hall of dazzling light."</i>
 
Over the last several years Nicky McClean from the Electricity Authority has put together a very small, but interesting hisotrial record of electricty generation in New Zealand.  The series, though likely not fully complete (especially in the early period) still gives a good indication of the growth in generation capacity in New Zealand throughout the 20th Century.

The data includes the estimated nameplate capacity, approximate commisioning and decommisioning dates as well as useful comments. Sometimes a start date has a precision down to the hour, at other times it is down to just the year (in which case it is assumed to be commissioned/decommisioned at the start of the year).  When generation is known to have an end date, or has been temporailtiy decommissioned, a negative of the nameplate value is used, allowing a computer program to correctly sum up total nameplate capacity over time.
    
The raw data file used in this paper is publically available as a simple ASCII text file and provided as part of the Centralised Data Set (CDS) (put footnote here on future of CDS).   As some care has been taken over the format of the file, it is able to be read (parsed) with a simple computer program.  In this case, a small python script has been used to parse the data into memory from where the data can then be examined for further analysis and illustration. 

After parsing this file, we see that perhaps the first recorded use of electricity in New Zealand was 127 years ago on the 3rd of February, 1886, at the private Bullendale gold mine (two years before the public power supply started at Reefton).  Interestingly, the Bullendale scheme was DC and included New Zealand's first DC transmission link from the power house to where the power was required at a nearby quartz stamping battery.   Two years later, on the 1st of August, 1888, Reefton demonstated the first public supply of electricity in New Zealand by turning on electric street lighting generated from a nearby hydro electric generator. 


\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
from pandas import *
import re,os
from datetime import timedelta,time
import pyodbc
import pandas.io.sql as sql
from matplotlib import dates

from ea_colours import *

%config InlineBackend.figure_format = 'svg'

path='/home/humed/Dropbox/EEA/EEA2013/data/'
os.chdir(path)

set_option('max_columns',1000)
set_option('max_rows',1000)
set_option('max_colwidth',1000)

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
font = {'family' : 'ariel',
        'weight' : 'bold',
        'size'   : 8}

matplotlib.rc('font', **font)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
import os
file_path = '../data/NominalGenerationCapacity.txt'
names=[]
description=[]
ND = open(file_path)
for line in ND:
    if line[0] !='%':
        if line.split('.')[0] == 'Nominal':
            names.append(line.split()[0])
            description.append(" ".join(line.split()[1:]))

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def parse_date(datestr): #this works, but is a bit of a mess really, -- not for Nicky's eyes...
    if '/' in datestr:
        if len(datestr.split('/'))<=2:
           year = datestr.split('/')[-1].strip()
           month = datestr.split('/')[-2].strip()
           dt = datetime(int(year),int(month),1)
        if len(datestr.split('/'))>2:
           year = datestr.split('/')[-1][0:4]
           month = datestr.split('/')[-2].strip()
           day = datestr.split('/')[0].strip()
           dt = datetime(int(year),int(month),int(day))
    else:
        dt = datetime(int(datestr.strip()),1,1)
    if '@' in datestr:   #need to add time     
        time_str = datestr.split('@')[1]
        if 'pm' in time_str:
            time_str = time_str.split('pm')[0]
            if ':' in time_str:
                hours = time_str.split(':')[0]
                minutes = time_str.split(':')[1]
                TD = timedelta(0,(int(hours) + 12)*3600 + int(minutes)*60)
                dt = dt + TD
            else:
                dt = dt + timedelta(0,(int(time_str) + 12)*3600)
        if 'am' in time_str:      
            time_str = time_str.split('am')[0]
            if ':' in time_str:
                hours = time_str.split(':')[0]
                minutes = time_str.split(':')[1]
                TD = timedelta(0,(int(hours))*3600 + int(minutes)*60)
                dt = dt + TD
            else:
                dt = dt + timedelta(0,(int(time_str))*3600)
    return dt
            
Nominal = {}

ND.seek(0)
for line in ND:
  if len(line[:-2]) > 1:
        if line[0] != '%':
           if line[0] == 'N':
              name = line.split()[0]
              dit = {}
              des = {}
              nextline = ND.next()
              while (len(nextline[:-2]) > 1) and (nextline[0] == ' ' and (nextline.lstrip()[0] != '%')):
                 date = parse_date(nextline[0:12])   
                 value = nextline[10:].split()[1].strip()
                 descriptionx = " ".join(nextline[10:].split()[2:])
                 if value == '.':
                    value = '0'
                 elif value[0] == '+':
                    value = old_value + float(value[1:])
                 elif value[0] == '-':
                    value = old_value - float(value[1:])
                 value = float(value)                       
                 old_value = value
                 dit[date] = value
                 des[date] = descriptionx   
                 try: 
                    nextline = ND.next()   
                 except:
                    break
              dit[datetime.now().replace(hour=0, minute=0, second=0, microsecond=0)] = value  #add the last value for today, which is often 0 as the plant is long gone!       
              #Nominal[name] = Series(dit)
              Nominal[name] = DataFrame({'Nameplate':Series(dit),'Description':Series(des)})
#Nominal = DataFrame(Nominal).fillna(method='pad')   
Nominal = Panel(Nominal)
Nominal.items = Nominal.items.map(lambda x: "_".join(x.split('.')[1:]))
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#Get Nameplate data and delete HVDC stuff
NP_MW = Nominal.ix[:,:,'Nameplate'].fillna(method='pad').fillna(0)
del NP_MW['HVDC_North_Pole1']
del NP_MW['HVDC_South_Pole1']
#Get desciption and comments data
Des =  Nominal.ix[:,:,'Description']
del Des['HVDC_North_Pole1']
del Des['HVDC_South_Pole1']

comments={}
for r in range(len(Des)):
    comments[Des.ix[r,:].name]=[" : ".join(x) for x in zip(list(Des.ix[r,:][Des.ix[r,:].notnull()].index),list(Des.ix[r,:][Des.ix[r,:].notnull()].values))]
comments=Series(comments)

total = DataFrame({'Total':NP_MW.sum(axis=1),'Comments':comments})
total['diff']=total.Total.diff()
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
total.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
                                                                                                                                                                                                                                                                                                                                                             Comments  \
1886-02-03                                                                                                                                                                                                                                                                    [Hydro_Bullendale : Trial run. Two 50HP Pelton wheels drove two DC generators, 750RPM.]   
1887-01-01                                                                                                                                                                                                                                                                                                                            [Hydro_Bullendale : Breakdown.]   
1887-06-01                                                                                                                                                                                                                              [Hydro_Bullendale : I'll guess just a few months. Solid aron armatures replaced by laminated, so I'll allow for more oomph..]   
1888-08-01                                                                                                                                                                                                                [Hydro_Reefton : First demonstration of the first power station in N.Z. for the purposes of public supply. 30 and 110V DC Crompton dynamo.]   
1889-06-01  [Hydro_Wellington_MannersStreet : Water mains supplied two 30HP "vortex" turbines driving a 15KW Gulcher single phase AC generator at 100V and 80cps., Hydro_Wellington_PanamaStreet : Water mains supplied (at no charge) two 30HP "vortex" turbines driving a 15KW Gulcher single phase AC generator at 100V and 80cps. What happened to the extra HP?]   

            Total  diff  
1886-02-03     50   NaN  
1887-01-01      0   -50  
1887-06-01     60    60  
1888-08-01     80    20  
1889-06-01    140    60  
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def description_filter(d):
    return d.split('\' ')[0].replace('\'','').replace('~','')

def return_name(n):
    n=n.split('.')
    if len(n) > 3:
        return n[3] 
    
def append_name(x):
    if x['name2']:
        return x['name1'] +'_'+x['name2']
    else:
        return x['name1']
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
name_des=DataFrame({'Description':Series(dict(zip(names,description)))})
name_des['type']=name_des.index.map(lambda x: x.split('.')[1])
name_des['name1']=name_des.index.map(lambda x: x.split('.')[2])
name_des['name2']=name_des.index.map(lambda x: return_name(x))

name_des=name_des.set_index('name1',drop=False)
name_des['head']=name_des['Description'].map(lambda x: description_filter(x))
name_des.index = name_des.apply(append_name,axis=1)
del name_des['name1']
del name_des['name2']
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
name_des
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
                                                                                                                                                                                                                           Description  \
Kawerau                        Drilling began for the paper mill in late 1952, with steam supply since 1957 for process heat and electricity generation. Many bores, much piping. Subsequent power plants were outside the paper mill.   
Mokai                                                                                                                                                                          Waste fluids reinjected, waste gases to the atmosphere.   
Ngatamariki                                                                                                                                                           Somewhere mear the hot springs west of Ohaaki, 38�32'S 176�10'E?   
Ngawha                                                                                                                                                                                     Unusually high emissions of carbon dioxide.   
Ohaaki                                                                                                                                                                                          HP turbines transferred from Wairakei.   
Poihipi                                                                                                                                                 Originally built for the Geysers geothermal field in the U.S.A, but never run.   
Rotokawa                                                                                                                                                                                            Unusually hot high-pressure steam.   
Rotokawa2                                                                                                                                                                                          Second development. (Nga Awa Purua)   
Tauhara_TeHuka                                                                                                                                                                                       Initially named Centennial Drive.   
Wairakei                                                                                                                  Geothermal steam supply has faltered, technique has improved, equipment shuffled about, auxiliary expansion.   
Wairakei_TeMihi                                                                                                                   Additional bores (there are always new bores), but also a part-replacement for the Wairakei station.   
North_Pole1                                                                                                                                                 High Voltage Direct Current transmission link, Benmore - Haywards, pole 1.   
North_Pole2                                                                                                                                                 High Voltage Direct Current transmission link, Benmore - Haywards, pole 2.   
South_Pole1                                                                                                                                                 High Voltage Direct Current transmission link, Haywards - Benmore, Pole 1.   
South_Pole2                                                                                                                                                 High Voltage Direct Current transmission link, Haywards - Benmore, Pole 2.   
Akaroa                                                                                                                                                                                                                       Head 295'   
Aniwhenua                                                                                                                                                                                                                    Head 125'   
Argyle                                                                                                                                                          Head 70' Branch river diversion at the junction with the Wairau river.   
Arnold                                                                                                                                                                            Head 36', later 42' Main storage is in Lake Brunner.   
ArthursPass                                                                                                                       Head 710' from atop the Devil's Punchbowl falls. Used to power the construction of the Otira tunnel.   
Brightwater                                                                                                                    Head ~30'? Farmer Robert Ellis gained a licence for the Waimea Electric Supply & Manufacturing Company.   
Brooklyn                                                                                                                                                                                               Head 960' Brooklyn Hydro power.   
Bullendale                                                                                      Head 185' First industrial supply in N.Z. that left the building. For the quartz stamping battery via the first (low voltage) DC link.   
Cleardale                                                                                                                             Unknown head, somewhere on the Little River. A steep mountainside. Most water is for irrigation.   
Clutha_Clyde                                                                                    Head 335' Water use constraints limit production to 432MW, however all turbines have achieved 120MW, and the total has exceeded 480MW.   
Clutha_Roxburgh                                                                                                                                                                         Head 150' Small storage in a long narrow lake.   
Cobb                                           Head 1876' then 1950' after the earth dam of 107' replaced the weir and its ad-hoc extensions. Highest head in N.Z. with the water jet emerging at about a third of the speed of sound.   
Coleridge                                                                                                                                                                                                   Head 490' To Christchurch.   
DawsonFalls                                                                                                                                                           Head 220' Dawson Falls Lodge. Mains electricity arrived in 1982.   
DeepStream                                                                                                                                                                  Head 460' and 435' at two power stations with long canals.   
Dillmans                                                                                                                                                                                                                     Head 150'   
Duffers                                                                                                                                                                                                                       Head 40'   
Earnscleugh                                                                                                                                                                      Earnscleugh No. 3 Dredging and Electric Power Company   
Falls                                                                                                                                                                                Head 100' Irrigation dam near St. Bathans, Otago.   
Flaxy                                                                                                                                                                                                     Head ~130' Upcanal of Wheao.   
Fox                                                                                                                                                                                                      Head ~750' Drains lake Gault.   
Fraser                                                                                                                                                                                                                       Head 800'   
Glenorchy                                                                                                                                                                                     Head 210' Pipeline from the Ox Burn dam.   
Hautapu                                                                                                                                                                                            Head 500' small wier then a tunnel.   
Highbank                                                                                                                                                                        Head 330' Tail end of the Rangitata irrigation scheme.   
Hinemaiaia                                                                                                                                                                           Multiple stations, small storage, swiftly silted.   
Kaniere_KaniereForks                                                                                                                                                                       Head ~250' Conversion of goldminer's works.   
Kaniere_McKaysCreek                                                                                                                                                                    Head ~180' Conversion of a gold-mining project.   
Kaponga                                                                                                                                                                         Head ~20`? Long before the natural gas well at Kapuni.   
Karaponga                                                                                                                                                                                   Head ~30 feet. Guesswork: the dam is 18'5"   
Kerikeri                                                                                                                                                                                                                    Head ~100'   
Kirikau                                                                                                                                                                                               Head ~130' Farmer Robert Carter.   
Kourarau                                                                                                                                                               Two power stations and pipes not shown on the topographic maps.   
Kumara                                                                                                                                                                                                                       Head 255'   
Kuratau                                                                                                                                                                                                                      Head 210'   
Manapouri                                                                                                                                                                    Head 580', slightly affected by the 7' tide at Deep Cove.   
Mangahao                                                                                                                                                                                                                     Head 896'   
Mangaio                                                                                                                                                                                                                     Head ~165'   
Mangamahoe                                                                                                                                                          Head 210'? The Mangorei river is downstream and has no connection.   
Mangapapa_Lower                                                                                                                                                                                                              Head 105'   
Mangapapa_Upper                                                                                                                                                                                               Head 497' Lloyd Mandeno.   
Mangapehi                                                                                                                                                                                                                   Head ~240'   
Mangaweka                                                                                                                                                                                  Head 30' Part of the water & sewage system.   
Matahina                                                                                                                                                                                                                     Head 200'   
Mataura                                                                                                                                                                Head 20' Southland Frozen Meat company, and Mataura Paper Mill.   
Matawai                                                                                                                                                                                      Head 512' Weir then pipeline. No storage.   
McLarenFalls                                                                                                                                                                                                                  Head 85'   
Mokauiti                                                                                                                                                                                                                     Head 140'   
Mokopeka                                                                                                      Supplied John Chamber's farm (homestead, workshop and shearing shed) plus a neighbour, so that'll do as "public supply".   
Monowai                                                                                                                                                                                                                      Head 154'   
Montalto                                                                                                                                                           Head 23' Part of the Rangitata river diversion, ending at Highbank.   
Motukawa                                                                                                                                                                                                                     Head 325'   
Nevis                                                                                                                                                    The gold dredge's hydro power came from a power house on the nearby hillside.   
Normanby                                                                                                                                  Head 60' Dam plus tunnel across the neck of a second-order meander of the Waingongoro river.   
OkereFalls                                                                                                                                                                        Head 14' Rotorua tourism lighting, and sewage pumps.   
OmanawaFalls                                                                                                                                                                                        Head 100' Underground power house.   
OneMileCreek                                                                                                                                                      Head 580' Dam on One Mile Creek above lake Wakatipu near Queenstown.   
Onekaka                                                                                                                                    Head 690' Originally a part of the Onakaka ironworks, then revived by Brian Leyland, et al.   
Opuha                                  Head 160' Overwhelmed by a flood during construction, 6'th Feb 1997. Assorted excitements follow. River flow restrictions usually limit full-power generation to bursts of a few hours at a go.   
Opunake                                                                                                                                                                                                                      Head ~60'   
Otira                                                                                                                                                     Head 750' from Holt's creek, flow abated by winter freezing and dry summers.   
Paerau                                                                                                                                                                                                 Head ~425' Upcanal of Patearoa.   
Patea                                                                                                                                                                            Head 270' Earth dam, serious difficulties with leaks.   
Patearoa                                                                                                                                                                                               Head ~120' Downcanal of Paerau.   
Piriaka                                                                                                                                                                                                                       Head 27'   
Pupu                                                                                                                                                                                 Head 300' Conversion of a goldminer's water race.   
Raetihi                                                                                                                                                                                                 Head ~260' Hidden in a ravine.   
Rangipo                                                                                                                                                                                             Head 788' Underground power house.   
Reefton                                                                                                                                                                                  Head 27' Reefton: first public supply in N.Z.   
RoaringMeg_Lower                                                                                                                                                                                                            Head 1000'   
RoaringMeg_Upper                                                                                                                                                   Head 450' Outfall to the intake for the lower Roaring Meg pipeline.   
Ruahihi                                                                                                                                                Head 280' Canal from Lake McLaren, superceding the McLaren Falls power station.   
SixMileCreek                                                                                                                                                                         Head ~40' Conversion of a goldminer's water race.   
SpeediesRoad                                                                                                                                                      Head 130' Riverside intake: no storage. Also known as Speedy's Road.   
Stratford                                                                                                                                                                          Head 12', tunnel across the neck of a hairpin bend.   
TallaBurn                                                                                                                                                                                                                   Head ~720'   
Tatare                                                                                                                                                                              Head ~50'? Takeover of a gold-sluicing water race.   
TeAroha                                                                                                                                                                               Head 500', though the map rather suggests ~900'.   
Teviot_Ellis                                                                                                                                                                                                                 Head 675'   
Teviot_George                                                                                                                                          Head 385' Multiple power stations along the Teviot river, starting with George.   
Teviot_HorseshoeBend                                                                                                                                                 Head 280' Tunnel then pipeline to the powerhouse well downstream.   
Teviot_Michelle                                                                                                                                                                                                              Head 243'   
Teviot_TeviotBridge                                                                                                                                                                                                          Head 300'   
Thames                                                                                                                                                                                                           Head ~50' at a guess.   
Tokaanu                                                                                                                                                                                                                      Head 682'   
TotoraValley                                                                                                                                                                                                             Rather local.   
Wahapo                                                                                                                                                                                      Head ~90' Previously called Okarito Forks.   
Waihi                                                                                                                                                                                                                       Head ~300'   
Waihopai                                                                                                                                                      Head 95' No storage: just a pond, soon filled (as expected) with gravel.   
Waikaremoana_Kaitawa                                                                                                                              Head 433' Lake Waikaremoana provides substantial storage compared to the water flow.   
Waikaremoana_Piripaua                                                                                                                                                             Head 370' From a small lake at the outlet from Tuai.   
Waikaremoana_Tuai                                                                                                                                                              Head 675' From a small lake at the outlet from Kaitawa.   
Waikato_Arapuni                                                                                                                                                                                                              Head 175'   
Waikato_Aratiatia                                                                                                                                                    Head 110' Minimal local lake. The main storage is via lake Taupo.   
Waikato_Atiamuri                                                                                                                                                                                                              Head 80'   
Waikato_Horahora                                                                                                                                                                       Head 27' Waihi Mining. First transmission line.   
Waikato_Karapiro                                                                                                                                                                                                             Head 100'   
Waikato_Maraetai                                                                                                                                                                                                             Head 200'   
Waikato_Ohakuri                                                                                                                                                                                                              Head 115'   
Waikato_Waipapa                                                                                                                                                                                                               Head 53'   
Waikato_Whakamaru                                                                                                                                                                                                            Head 124'   
Waipori                                                                                                                                                             Dunedin City Council won the squabble. Construction began in 1903.   
Wairau                                                                                                                                                                                                Head 135' Downcanal from Argyle.   
Wairere                                                                                                                                                                                       Head 65' King Country, not by Whakatane.   
WairuaFalls                                                                                                                                                                                                      Head ~100' Northland.   
Waitaki_Aviemore                                                                                                                                                                                                             Head 122'   
Waitaki_Benmore                                                                                                                                                                                           Head 300' Massive earth dam.   
Waitaki_Ohau                                                                                                                                                                                                                 Head 190'   
Waitaki_Ohau                                                                                                                                                                                                                 Head 157'   
Waitaki_Ohau                                                                                                                                                                                            Head 157' Same head as Ohau B.   
Waitaki_Pukaki                                                                                                                                                                                                               Head 480'   
Waitaki_Tekapo                                                                                                                                                                                                               Head 100'   
Waitaki_Waitaki                                                                                                                                                                                                               Head 70'   
Wellington_MannersStreet                                                                                                                                               Head ~100'? Water main supply, discharge to the Te Aro stream..   
Wellington_PanamaStreet                                                                                                                                                      Head ~100'? Water main supply, discharge to the harbour..   
Wheao                                                                                                                                                                                                   Head ~400' Downcanal of Flaxy.   
WyeCreek                                                                                                                                                                                                                   Head ~1380'   
Auckland_Airport                                                                                                                                                                                    Auckland Airport Pier B expansion.   
Drury                                                                                                                                                                           South Auckland Forgings Engineering (SAFE or S.A.F.E.)   
Lyttelton                                                                                                                                                                                                       Lyttleton Main School.   
ManaIsland                                                                                                                                                                           Department of Conservation Building, Mana Island.   
Mangere                                                                                                                                                                                                         Hubbard Foods factory.   
Rangiora                                                                                                                                                                                                  Somewhere in the high school   
Ashburton                                                                                                                                                                                    Steam tractor engine, Craddock & Company.   
Auckland_FreemansBay                                                                                                                                                          Rubbish power ("Destructor"), soon supplemented by coal.   
Auckland_Hobson                    Hobson Street power station for the Tramways (mercury rectifier for DC), plus a requirement for Queen Street lighting. Waste heat to the 1914 Tepid Baths. Co-generation is not just a modern idea!   
Auckland_KingsWharf                                                                                                                                                                            Public supply, surplus to the tramways.   
Awapuni                                                                                                                                                                      Landfill gas from a retired but still festering landfill.   
BreamBay                                                                                                                                                                                                           Five 1�8MW diesels.   
Bromley                                                                                                                                                                                                           Sewage digester gas.   
Burwood                                                                                                            Landfill gas, for the Queen Elizabeth II sports stadium: power and exhaust heat, more gas is burnt for direct heat.   
Christchurch_Armargh                                                                                                                                                               Armargh Street Rubbish Destructor, then added coal.   
Christchurch_FalsgraveStreet                                                                                                                                                                                         Tramways' Supply.   
ComicalHill                                                                                                                                                                                          Blue Mountain Lumber. Wood waste.   
Edgecumbe                                                                                                                                                                                          Co-generation at the dairy factory.   
EvansBay                                                                                                                                                                          Warm water was appreciated by swimmers, and fishers.   
Greenmount                                                                                                                                                                           Landfill gas. Established 1980, closed July 2005.   
HamptonDowns                                                                                                                                                                                      Landfill gas. Established July 2005.   
Horotiu                                                                                                                                                                                                                  Landfill gas.   
Huntly                                                                          Four three-stage 250MW steam turbines, inlet 1000�F and 2,300psi, cooled by Waikato river water. 2004 a gas turbine. 2007 a 385MW gas & steam turbine.   
Kapuni                                                 Kapuni gas treatment plant. A miscellany of two 10�5MW gas turbines, exhaust heats steam for a 1�5MW turbine, steam also goes to the nearby dairy factory with 3�5MW generated.   
Kerikeri                                                                                                                                                                                         Fuelled by wood waste at the sawmill.   
Kinleith                                                                                                                                                                                     Timber mill: wood waste plus natural gas.   
Mangahewa_Grid                                                                                                                                                           Two 50MW gas turbines, SSE of the McKee "production station".   
Mangahewa_McKee               The McKee "Production station" by Mangahewa. Sent forth at 11KV for 2MW from McKee (exhaust heats water for process use), 33KV for 9MW from "Mangahewa", also within the McKee Production Station fence.   
Mangere                                                                                                                                                                Sewage treatment. All used internally, with heat recovery also.   
Marsden_A                                                                                                                                                              Heavy oil fired, steam at 1000F, 1,525psi, cooled by sea water.   
Marsden_B                                                                                                                                                                               More of the same, but collapsed in dissension.   
Mataura                                                                                                                                                                  Mataura Paper Mill. Also has a share in the hydro generation.   
Meremere                                                                                                             Coal-fired, steam turbines at 865F, 640psi. Cooling from the Waikato. Standard design enabled swift construction.   
Mokoia                                                                                                                                               Gas engines fed from byproducts of the oil/gas processing station at Mokoia Road.   
Nelson                                                                                                                                                                                                                 Wakefield Quay.   
NewPlymouth                                                                                                                                  Oil, then gas-fired. Steam turbines, 1000�F, 1,800psi, three stages, cooled by sea water.   
Otahuhu_A                                                                                                               Gas turbines. At first from Kapuni, expensive deisel during peak times. Originally named Otara, from its site.   
Otahuhu_B                                                                                                                                                                  Two cycle: gas turbine, exhaust heat boiler, steam turbine.   
Otira                                              DC power for the electric trains running through the Otira tunnel (1:33 grade). Though rated at 2400KW, frequently run at 125% for half an hour: train transit time of ~28 minutes.   
Owhiro                                                                                                                                                                                                                   Landfill gas.   
PalmerstonNorth                                                                                                                                            The Palmerston North City Council for the Municipal Electricity Department.   
Pukete                                                                                                                                               Sewage digester gas, plus natural gas. Electricity generation and waste-heat use.   
Redvale                                                Landfill gas. Established August 1993. Passive gas collection with flaring began 1996, active collection November 1998; flaring converted to leachate evaporation in June 1999.   
Reefton                                                                                                                                                                         Steam power to support the Reefton hydro power scheme.   
Rosedale                                                                                                                                                                                                                 Landfill gas.   
Silverstream                                                                                                                                                                                                             Landfill gas.   
Southdown                                                                                                                                                                                          Supplies steam for nearby industry.   
Springlands                                                                                                                                                     Supplements Waihopai when the ground is frozen and little water flows.   
Stoke                                                                                                                                                                               Diesel engines, installed at the Stoke substation.   
Stratford_A                                                                                                                                     Aero-derived Pratt&Whitney turbines, first fed Kapuni gas, later Maui and Waihapa gas.   
Stratford_B                                                                                                                                                          One gas and one steam turbine, both on the one shaft, air cooled.   
Stratford_C                                                                                                                                                                                                              Gas turbines.   
TeAwamutu                                                                                                        Dairy factory co-generation. Originally coal-fired boilers, but concerted to natural gas with the co-generation plan.   
TeRapa                                                                                                                                                                                                                  Dairy factory.   
Tirohia                                                                                                                                                                                              Landfill gas, expansion expected.   
Waihi                                                                                                                               Grand Junction mine, Waihi. Additional generation via a Pelton wheel, steam engines, and coal-gas.   
Waipa                                                                                                                                                                                                         Timber mill: wood waste.   
Wellington_HarrisStreet                                                                                                                                                                            Mostly covered by the city library.   
Wellington_JervoisQuay                                                                                                                                                                         Tramways' supply, then street lighting.   
Whareroa                                                                                                                                                                                          Co-generation for the dairy factory.   
Whirinaki                                                                                                                                                                        Aero-derived Pratt&Whitney turbines, fired by diesel.   
Whitford                                                                                                                                      Landfill gas. Established 1953, modern style since July 1994. Supplies the 11KV network.   
Brooklyn                                                                                                                                       Installed to propagandise and obtain data. Most data has been lost in re-organisations.   
ChathamIsland                                                                                                                                                       Wind farm. 2�225KW = 450KW, supplements diesel of ~400KW capacity.   
GebbiesPass                                                                                                                                                                                           Wind turbine, test installation.   
HauNui                                                                                                                                                                                                          Wind farm, two stages.   
HorseshoeBend                                                                                                                                                                                              Wind farm. 3�750KW = 2�25MW   
Lulworth                                                                                                                                                                                         Wind farm. 4�250KW = 1MW. Ex-Denmark.   
Mahinerangi                                                                                                                                                                      Wind farm. 12�3 = 36MW. Further turbines are allowed.   
Makara                                                                                                                                                   Makara wind farm ("West Wind") 62�2�3 = 142�6MW, but peaking at 134�4 so far.   
MountStuart                                                                                                                                                                   Wind farm. 9�850KW = 7�65MW. Gamesa turbines from Spain.   
Seaview                                                                                                                                     Demonstration installation, "Proven" wind turbine, no gearbox. Three-blade, tower mounted.   
Southbridge                                                                                                                                                                                      Lonely Tellus turbine. Lattice tower.   
Tararua                                                                                                                                                                                                  Wind farm in multiple stages.   
TeApiti                                                                                                                                                                                               Wind farm 55�1�65MW for 90�75MW.   
TeRereHau                                                    Wind farm. 97�500KW, initially five wind turbines so 2�5MW, but only 1MW can be sent along its connection. Expansion and reconnection late 2009, but details are unclear.   
TeUku                                                                                                                                                                                                      Wind farm. 28�2�3 = 64�4MW.   
WeldCone                                                                                                                                                                                                    Wind farm. 3�250KW = 750KW   
WhiteHill                                                                                                                                                                                                  Wind farm. 29�2MW for 58MW.   

                                    type  \
Kawerau                       Geothermal   
Mokai                         Geothermal   
Ngatamariki                   Geothermal   
Ngawha                        Geothermal   
Ohaaki                        Geothermal   
Poihipi                       Geothermal   
Rotokawa                      Geothermal   
Rotokawa2                     Geothermal   
Tauhara_TeHuka                Geothermal   
Wairakei                      Geothermal   
Wairakei_TeMihi               Geothermal   
North_Pole1                         HVDC   
North_Pole2                         HVDC   
South_Pole1                         HVDC   
South_Pole2                         HVDC   
Akaroa                             Hydro   
Aniwhenua                          Hydro   
Argyle                             Hydro   
Arnold                             Hydro   
ArthursPass                        Hydro   
Brightwater                        Hydro   
Brooklyn                           Hydro   
Bullendale                         Hydro   
Cleardale                          Hydro   
Clutha_Clyde                       Hydro   
Clutha_Roxburgh                    Hydro   
Cobb                               Hydro   
Coleridge                          Hydro   
DawsonFalls                        Hydro   
DeepStream                         Hydro   
Dillmans                           Hydro   
Duffers                            Hydro   
Earnscleugh                        Hydro   
Falls                              Hydro   
Flaxy                              Hydro   
Fox                                Hydro   
Fraser                             Hydro   
Glenorchy                          Hydro   
Hautapu                            Hydro   
Highbank                           Hydro   
Hinemaiaia                         Hydro   
Kaniere_KaniereForks               Hydro   
Kaniere_McKaysCreek                Hydro   
Kaponga                            Hydro   
Karaponga                          Hydro   
Kerikeri                           Hydro   
Kirikau                            Hydro   
Kourarau                           Hydro   
Kumara                             Hydro   
Kuratau                            Hydro   
Manapouri                          Hydro   
Mangahao                           Hydro   
Mangaio                            Hydro   
Mangamahoe                         Hydro   
Mangapapa_Lower                    Hydro   
Mangapapa_Upper                    Hydro   
Mangapehi                          Hydro   
Mangaweka                          Hydro   
Matahina                           Hydro   
Mataura                            Hydro   
Matawai                            Hydro   
McLarenFalls                       Hydro   
Mokauiti                           Hydro   
Mokopeka                           Hydro   
Monowai                            Hydro   
Montalto                           Hydro   
Motukawa                           Hydro   
Nevis                              Hydro   
Normanby                           Hydro   
OkereFalls                         Hydro   
OmanawaFalls                       Hydro   
OneMileCreek                       Hydro   
Onekaka                            Hydro   
Opuha                              Hydro   
Opunake                            Hydro   
Otira                              Hydro   
Paerau                             Hydro   
Patea                              Hydro   
Patearoa                           Hydro   
Piriaka                            Hydro   
Pupu                               Hydro   
Raetihi                            Hydro   
Rangipo                            Hydro   
Reefton                            Hydro   
RoaringMeg_Lower                   Hydro   
RoaringMeg_Upper                   Hydro   
Ruahihi                            Hydro   
SixMileCreek                       Hydro   
SpeediesRoad                       Hydro   
Stratford                          Hydro   
TallaBurn                          Hydro   
Tatare                             Hydro   
TeAroha                            Hydro   
Teviot_Ellis                       Hydro   
Teviot_George                      Hydro   
Teviot_HorseshoeBend               Hydro   
Teviot_Michelle                    Hydro   
Teviot_TeviotBridge                Hydro   
Thames                             Hydro   
Tokaanu                            Hydro   
TotoraValley                       Hydro   
Wahapo                             Hydro   
Waihi                              Hydro   
Waihopai                           Hydro   
Waikaremoana_Kaitawa               Hydro   
Waikaremoana_Piripaua              Hydro   
Waikaremoana_Tuai                  Hydro   
Waikato_Arapuni                    Hydro   
Waikato_Aratiatia                  Hydro   
Waikato_Atiamuri                   Hydro   
Waikato_Horahora                   Hydro   
Waikato_Karapiro                   Hydro   
Waikato_Maraetai                   Hydro   
Waikato_Ohakuri                    Hydro   
Waikato_Waipapa                    Hydro   
Waikato_Whakamaru                  Hydro   
Waipori                            Hydro   
Wairau                             Hydro   
Wairere                            Hydro   
WairuaFalls                        Hydro   
Waitaki_Aviemore                   Hydro   
Waitaki_Benmore                    Hydro   
Waitaki_Ohau                       Hydro   
Waitaki_Ohau                       Hydro   
Waitaki_Ohau                       Hydro   
Waitaki_Pukaki                     Hydro   
Waitaki_Tekapo                     Hydro   
Waitaki_Waitaki                    Hydro   
Wellington_MannersStreet           Hydro   
Wellington_PanamaStreet            Hydro   
Wheao                              Hydro   
WyeCreek                           Hydro   
Auckland_Airport                   Solar   
Drury                              Solar   
Lyttelton                          Solar   
ManaIsland                         Solar   
Mangere                            Solar   
Rangiora                           Solar   
Ashburton                        Thermal   
Auckland_FreemansBay             Thermal   
Auckland_Hobson                  Thermal   
Auckland_KingsWharf              Thermal   
Awapuni                          Thermal   
BreamBay                         Thermal   
Bromley                          Thermal   
Burwood                          Thermal   
Christchurch_Armargh             Thermal   
Christchurch_FalsgraveStreet     Thermal   
ComicalHill                      Thermal   
Edgecumbe                        Thermal   
EvansBay                         Thermal   
Greenmount                       Thermal   
HamptonDowns                     Thermal   
Horotiu                          Thermal   
Huntly                           Thermal   
Kapuni                           Thermal   
Kerikeri                         Thermal   
Kinleith                         Thermal   
Mangahewa_Grid                   Thermal   
Mangahewa_McKee                  Thermal   
Mangere                          Thermal   
Marsden_A                        Thermal   
Marsden_B                        Thermal   
Mataura                          Thermal   
Meremere                         Thermal   
Mokoia                           Thermal   
Nelson                           Thermal   
NewPlymouth                      Thermal   
Otahuhu_A                        Thermal   
Otahuhu_B                        Thermal   
Otira                            Thermal   
Owhiro                           Thermal   
PalmerstonNorth                  Thermal   
Pukete                           Thermal   
Redvale                          Thermal   
Reefton                          Thermal   
Rosedale                         Thermal   
Silverstream                     Thermal   
Southdown                        Thermal   
Springlands                      Thermal   
Stoke                            Thermal   
Stratford_A                      Thermal   
Stratford_B                      Thermal   
Stratford_C                      Thermal   
TeAwamutu                        Thermal   
TeRapa                           Thermal   
Tirohia                          Thermal   
Waihi                            Thermal   
Waipa                            Thermal   
Wellington_HarrisStreet          Thermal   
Wellington_JervoisQuay           Thermal   
Whareroa                         Thermal   
Whirinaki                        Thermal   
Whitford                         Thermal   
Brooklyn                            Wind   
ChathamIsland                       Wind   
GebbiesPass                         Wind   
HauNui                              Wind   
HorseshoeBend                       Wind   
Lulworth                            Wind   
Mahinerangi                         Wind   
Makara                              Wind   
MountStuart                         Wind   
Seaview                             Wind   
Southbridge                         Wind   
Tararua                             Wind   
TeApiti                             Wind   
TeRereHau                           Wind   
TeUku                               Wind   
WeldCone                            Wind   
WhiteHill                           Wind   

                                                                                                                                                                                                                                  head  
Kawerau                        Drilling began for the paper mill in late 1952, with steam supply since 1957 for process heat and electricity generation. Many bores, much piping. Subsequent power plants were outside the paper mill.  
Mokai                                                                                                                                                                          Waste fluids reinjected, waste gases to the atmosphere.  
Ngatamariki                                                                                                                                                             Somewhere mear the hot springs west of Ohaaki, 38�32S 176�10E?  
Ngawha                                                                                                                                                                                     Unusually high emissions of carbon dioxide.  
Ohaaki                                                                                                                                                                                          HP turbines transferred from Wairakei.  
Poihipi                                                                                                                                                 Originally built for the Geysers geothermal field in the U.S.A, but never run.  
Rotokawa                                                                                                                                                                                            Unusually hot high-pressure steam.  
Rotokawa2                                                                                                                                                                                          Second development. (Nga Awa Purua)  
Tauhara_TeHuka                                                                                                                                                                                       Initially named Centennial Drive.  
Wairakei                                                                                                                  Geothermal steam supply has faltered, technique has improved, equipment shuffled about, auxiliary expansion.  
Wairakei_TeMihi                                                                                                                   Additional bores (there are always new bores), but also a part-replacement for the Wairakei station.  
North_Pole1                                                                                                                                                 High Voltage Direct Current transmission link, Benmore - Haywards, pole 1.  
North_Pole2                                                                                                                                                 High Voltage Direct Current transmission link, Benmore - Haywards, pole 2.  
South_Pole1                                                                                                                                                 High Voltage Direct Current transmission link, Haywards - Benmore, Pole 1.  
South_Pole2                                                                                                                                                 High Voltage Direct Current transmission link, Haywards - Benmore, Pole 2.  
Akaroa                                                                                                                                                                                                                        Head 295  
Aniwhenua                                                                                                                                                                                                                     Head 125  
Argyle                                                                                                                                                                                                                         Head 70  
Arnold                                                                                                                                                                                                               Head 36, later 42  
ArthursPass                                                                                                                                                                                                                   Head 710  
Brightwater                                                                                                                      Head 30? Farmer Robert Ellis gained a licence for the Waimea Electric Supply & Manufacturing Company.  
Brooklyn                                                                                                                                                                                                                      Head 960  
Bullendale                                                                                                                                                                                                                    Head 185  
Cleardale                                                                                                                             Unknown head, somewhere on the Little River. A steep mountainside. Most water is for irrigation.  
Clutha_Clyde                                                                                                                                                                                                                  Head 335  
Clutha_Roxburgh                                                                                                                                                                                                               Head 150  
Cobb                                                                                                                                                                                                                         Head 1876  
Coleridge                                                                                                                                                                                                                     Head 490  
DawsonFalls                                                                                                                                                                                                                   Head 220  
DeepStream                                                                                                                                                                                                                    Head 460  
Dillmans                                                                                                                                                                                                                      Head 150  
Duffers                                                                                                                                                                                                                        Head 40  
Earnscleugh                                                                                                                                                                      Earnscleugh No. 3 Dredging and Electric Power Company  
Falls                                                                                                                                                                                                                         Head 100  
Flaxy                                                                                                                                                                                                                         Head 130  
Fox                                                                                                                                                                                                                           Head 750  
Fraser                                                                                                                                                                                                                        Head 800  
Glenorchy                                                                                                                                                                                                                     Head 210  
Hautapu                                                                                                                                                                                                                       Head 500  
Highbank                                                                                                                                                                                                                      Head 330  
Hinemaiaia                                                                                                                                                                           Multiple stations, small storage, swiftly silted.  
Kaniere_KaniereForks                                                                                                                                                                                                          Head 250  
Kaniere_McKaysCreek                                                                                                                                                                                                           Head 180  
Kaponga                                                                                                                                                                          Head 20`? Long before the natural gas well at Kapuni.  
Karaponga                                                                                                                                                                                     Head 30 feet. Guesswork: the dam is 185"  
Kerikeri                                                                                                                                                                                                                      Head 100  
Kirikau                                                                                                                                                                                                                       Head 130  
Kourarau                                                                                                                                                               Two power stations and pipes not shown on the topographic maps.  
Kumara                                                                                                                                                                                                                        Head 255  
Kuratau                                                                                                                                                                                                                       Head 210  
Manapouri                                                                                                                                                                                         Head 580, slightly affected by the 7  
Mangahao                                                                                                                                                                                                                      Head 896  
Mangaio                                                                                                                                                                                                                       Head 165  
Mangamahoe                                                                                                                                                           Head 210? The Mangorei river is downstream and has no connection.  
Mangapapa_Lower                                                                                                                                                                                                               Head 105  
Mangapapa_Upper                                                                                                                                                                                                               Head 497  
Mangapehi                                                                                                                                                                                                                     Head 240  
Mangaweka                                                                                                                                                                                                                      Head 30  
Matahina                                                                                                                                                                                                                      Head 200  
Mataura                                                                                                                                                                                                                        Head 20  
Matawai                                                                                                                                                                                                                       Head 512  
McLarenFalls                                                                                                                                                                                                                   Head 85  
Mokauiti                                                                                                                                                                                                                      Head 140  
Mokopeka                                                                                                        Supplied John Chambers farm (homestead, workshop and shearing shed) plus a neighbour, so thatll do as "public supply".  
Monowai                                                                                                                                                                                                                       Head 154  
Montalto                                                                                                                                                                                                                       Head 23  
Motukawa                                                                                                                                                                                                                      Head 325  
Nevis                                                                                                                                                     The gold dredges hydro power came from a power house on the nearby hillside.  
Normanby                                                                                                                                                                                                                       Head 60  
OkereFalls                                                                                                                                                                                                                     Head 14  
OmanawaFalls                                                                                                                                                                                                                  Head 100  
OneMileCreek                                                                                                                                                                                                                  Head 580  
Onekaka                                                                                                                                                                                                                       Head 690  
Opuha                                                                                                                                                                                                                         Head 160  
Opunake                                                                                                                                                                                                                        Head 60  
Otira                                                                                                                                                                                                                         Head 750  
Paerau                                                                                                                                                                                                                        Head 425  
Patea                                                                                                                                                                                                                         Head 270  
Patearoa                                                                                                                                                                                                                      Head 120  
Piriaka                                                                                                                                                                                                                        Head 27  
Pupu                                                                                                                                                                                                                          Head 300  
Raetihi                                                                                                                                                                                                                       Head 260  
Rangipo                                                                                                                                                                                                                       Head 788  
Reefton                                                                                                                                                                                                                        Head 27  
RoaringMeg_Lower                                                                                                                                                                                                             Head 1000  
RoaringMeg_Upper                                                                                                                                                                                                              Head 450  
Ruahihi                                                                                                                                                                                                                       Head 280  
SixMileCreek                                                                                                                                                                                                                   Head 40  
SpeediesRoad                                                                                                                                                                                                                  Head 130  
Stratford                                                                                                                                                                           Head 12, tunnel across the neck of a hairpin bend.  
TallaBurn                                                                                                                                                                                                                     Head 720  
Tatare                                                                                                                                                                                Head 50? Takeover of a gold-sluicing water race.  
TeAroha                                                                                                                                                                                  Head 500, though the map rather suggests 900.  
Teviot_Ellis                                                                                                                                                                                                                  Head 675  
Teviot_George                                                                                                                                                                                                                 Head 385  
Teviot_HorseshoeBend                                                                                                                                                                                                          Head 280  
Teviot_Michelle                                                                                                                                                                                                               Head 243  
Teviot_TeviotBridge                                                                                                                                                                                                           Head 300  
Thames                                                                                                                                                                                                                         Head 50  
Tokaanu                                                                                                                                                                                                                       Head 682  
TotoraValley                                                                                                                                                                                                             Rather local.  
Wahapo                                                                                                                                                                                                                         Head 90  
Waihi                                                                                                                                                                                                                         Head 300  
Waihopai                                                                                                                                                                                                                       Head 95  
Waikaremoana_Kaitawa                                                                                                                                                                                                          Head 433  
Waikaremoana_Piripaua                                                                                                                                                                                                         Head 370  
Waikaremoana_Tuai                                                                                                                                                                                                             Head 675  
Waikato_Arapuni                                                                                                                                                                                                               Head 175  
Waikato_Aratiatia                                                                                                                                                                                                             Head 110  
Waikato_Atiamuri                                                                                                                                                                                                               Head 80  
Waikato_Horahora                                                                                                                                                                                                               Head 27  
Waikato_Karapiro                                                                                                                                                                                                              Head 100  
Waikato_Maraetai                                                                                                                                                                                                              Head 200  
Waikato_Ohakuri                                                                                                                                                                                                               Head 115  
Waikato_Waipapa                                                                                                                                                                                                                Head 53  
Waikato_Whakamaru                                                                                                                                                                                                             Head 124  
Waipori                                                                                                                                                             Dunedin City Council won the squabble. Construction began in 1903.  
Wairau                                                                                                                                                                                                                        Head 135  
Wairere                                                                                                                                                                                                                        Head 65  
WairuaFalls                                                                                                                                                                                                                   Head 100  
Waitaki_Aviemore                                                                                                                                                                                                              Head 122  
Waitaki_Benmore                                                                                                                                                                                                               Head 300  
Waitaki_Ohau                                                                                                                                                                                                                  Head 190  
Waitaki_Ohau                                                                                                                                                                                                                  Head 157  
Waitaki_Ohau                                                                                                                                                                                                                  Head 157  
Waitaki_Pukaki                                                                                                                                                                                                                Head 480  
Waitaki_Tekapo                                                                                                                                                                                                                Head 100  
Waitaki_Waitaki                                                                                                                                                                                                                Head 70  
Wellington_MannersStreet                                                                                                                                                 Head 100? Water main supply, discharge to the Te Aro stream..  
Wellington_PanamaStreet                                                                                                                                                        Head 100? Water main supply, discharge to the harbour..  
Wheao                                                                                                                                                                                                                         Head 400  
WyeCreek                                                                                                                                                                                                                     Head 1380  
Auckland_Airport                                                                                                                                                                                    Auckland Airport Pier B expansion.  
Drury                                                                                                                                                                           South Auckland Forgings Engineering (SAFE or S.A.F.E.)  
Lyttelton                                                                                                                                                                                                       Lyttleton Main School.  
ManaIsland                                                                                                                                                                           Department of Conservation Building, Mana Island.  
Mangere                                                                                                                                                                                                         Hubbard Foods factory.  
Rangiora                                                                                                                                                                                                  Somewhere in the high school  
Ashburton                                                                                                                                                                                    Steam tractor engine, Craddock & Company.  
Auckland_FreemansBay                                                                                                                                                          Rubbish power ("Destructor"), soon supplemented by coal.  
Auckland_Hobson                    Hobson Street power station for the Tramways (mercury rectifier for DC), plus a requirement for Queen Street lighting. Waste heat to the 1914 Tepid Baths. Co-generation is not just a modern idea!  
Auckland_KingsWharf                                                                                                                                                                            Public supply, surplus to the tramways.  
Awapuni                                                                                                                                                                      Landfill gas from a retired but still festering landfill.  
BreamBay                                                                                                                                                                                                           Five 1�8MW diesels.  
Bromley                                                                                                                                                                                                           Sewage digester gas.  
Burwood                                                                                                            Landfill gas, for the Queen Elizabeth II sports stadium: power and exhaust heat, more gas is burnt for direct heat.  
Christchurch_Armargh                                                                                                                                                               Armargh Street Rubbish Destructor, then added coal.  
Christchurch_FalsgraveStreet                                                                                                                                                                                                  Tramways  
ComicalHill                                                                                                                                                                                          Blue Mountain Lumber. Wood waste.  
Edgecumbe                                                                                                                                                                                          Co-generation at the dairy factory.  
EvansBay                                                                                                                                                                          Warm water was appreciated by swimmers, and fishers.  
Greenmount                                                                                                                                                                           Landfill gas. Established 1980, closed July 2005.  
HamptonDowns                                                                                                                                                                                      Landfill gas. Established July 2005.  
Horotiu                                                                                                                                                                                                                  Landfill gas.  
Huntly                                                                          Four three-stage 250MW steam turbines, inlet 1000�F and 2,300psi, cooled by Waikato river water. 2004 a gas turbine. 2007 a 385MW gas & steam turbine.  
Kapuni                                                 Kapuni gas treatment plant. A miscellany of two 10�5MW gas turbines, exhaust heats steam for a 1�5MW turbine, steam also goes to the nearby dairy factory with 3�5MW generated.  
Kerikeri                                                                                                                                                                                         Fuelled by wood waste at the sawmill.  
Kinleith                                                                                                                                                                                     Timber mill: wood waste plus natural gas.  
Mangahewa_Grid                                                                                                                                                           Two 50MW gas turbines, SSE of the McKee "production station".  
Mangahewa_McKee               The McKee "Production station" by Mangahewa. Sent forth at 11KV for 2MW from McKee (exhaust heats water for process use), 33KV for 9MW from "Mangahewa", also within the McKee Production Station fence.  
Mangere                                                                                                                                                                Sewage treatment. All used internally, with heat recovery also.  
Marsden_A                                                                                                                                                              Heavy oil fired, steam at 1000F, 1,525psi, cooled by sea water.  
Marsden_B                                                                                                                                                                               More of the same, but collapsed in dissension.  
Mataura                                                                                                                                                                  Mataura Paper Mill. Also has a share in the hydro generation.  
Meremere                                                                                                             Coal-fired, steam turbines at 865F, 640psi. Cooling from the Waikato. Standard design enabled swift construction.  
Mokoia                                                                                                                                               Gas engines fed from byproducts of the oil/gas processing station at Mokoia Road.  
Nelson                                                                                                                                                                                                                 Wakefield Quay.  
NewPlymouth                                                                                                                                  Oil, then gas-fired. Steam turbines, 1000�F, 1,800psi, three stages, cooled by sea water.  
Otahuhu_A                                                                                                               Gas turbines. At first from Kapuni, expensive deisel during peak times. Originally named Otara, from its site.  
Otahuhu_B                                                                                                                                                                  Two cycle: gas turbine, exhaust heat boiler, steam turbine.  
Otira                                               DC power for the electric trains running through the Otira tunnel (1:33 grade). Though rated at 2400KW, frequently run at 125% for half an hour: train transit time of 28 minutes.  
Owhiro                                                                                                                                                                                                                   Landfill gas.  
PalmerstonNorth                                                                                                                                            The Palmerston North City Council for the Municipal Electricity Department.  
Pukete                                                                                                                                               Sewage digester gas, plus natural gas. Electricity generation and waste-heat use.  
Redvale                                                Landfill gas. Established August 1993. Passive gas collection with flaring began 1996, active collection November 1998; flaring converted to leachate evaporation in June 1999.  
Reefton                                                                                                                                                                         Steam power to support the Reefton hydro power scheme.  
Rosedale                                                                                                                                                                                                                 Landfill gas.  
Silverstream                                                                                                                                                                                                             Landfill gas.  
Southdown                                                                                                                                                                                          Supplies steam for nearby industry.  
Springlands                                                                                                                                                     Supplements Waihopai when the ground is frozen and little water flows.  
Stoke                                                                                                                                                                               Diesel engines, installed at the Stoke substation.  
Stratford_A                                                                                                                                     Aero-derived Pratt&Whitney turbines, first fed Kapuni gas, later Maui and Waihapa gas.  
Stratford_B                                                                                                                                                          One gas and one steam turbine, both on the one shaft, air cooled.  
Stratford_C                                                                                                                                                                                                              Gas turbines.  
TeAwamutu                                                                                                        Dairy factory co-generation. Originally coal-fired boilers, but concerted to natural gas with the co-generation plan.  
TeRapa                                                                                                                                                                                                                  Dairy factory.  
Tirohia                                                                                                                                                                                              Landfill gas, expansion expected.  
Waihi                                                                                                                               Grand Junction mine, Waihi. Additional generation via a Pelton wheel, steam engines, and coal-gas.  
Waipa                                                                                                                                                                                                         Timber mill: wood waste.  
Wellington_HarrisStreet                                                                                                                                                                            Mostly covered by the city library.  
Wellington_JervoisQuay                                                                                                                                                                                                        Tramways  
Whareroa                                                                                                                                                                                          Co-generation for the dairy factory.  
Whirinaki                                                                                                                                                                        Aero-derived Pratt&Whitney turbines, fired by diesel.  
Whitford                                                                                                                                      Landfill gas. Established 1953, modern style since July 1994. Supplies the 11KV network.  
Brooklyn                                                                                                                                       Installed to propagandise and obtain data. Most data has been lost in re-organisations.  
ChathamIsland                                                                                                                                                        Wind farm. 2�225KW = 450KW, supplements diesel of 400KW capacity.  
GebbiesPass                                                                                                                                                                                           Wind turbine, test installation.  
HauNui                                                                                                                                                                                                          Wind farm, two stages.  
HorseshoeBend                                                                                                                                                                                              Wind farm. 3�750KW = 2�25MW  
Lulworth                                                                                                                                                                                         Wind farm. 4�250KW = 1MW. Ex-Denmark.  
Mahinerangi                                                                                                                                                                      Wind farm. 12�3 = 36MW. Further turbines are allowed.  
Makara                                                                                                                                                   Makara wind farm ("West Wind") 62�2�3 = 142�6MW, but peaking at 134�4 so far.  
MountStuart                                                                                                                                                                   Wind farm. 9�850KW = 7�65MW. Gamesa turbines from Spain.  
Seaview                                                                                                                                     Demonstration installation, "Proven" wind turbine, no gearbox. Three-blade, tower mounted.  
Southbridge                                                                                                                                                                                      Lonely Tellus turbine. Lattice tower.  
Tararua                                                                                                                                                                                                  Wind farm in multiple stages.  
TeApiti                                                                                                                                                                                               Wind farm 55�1�65MW for 90�75MW.  
TeRereHau                                                    Wind farm. 97�500KW, initially five wind turbines so 2�5MW, but only 1MW can be sent along its connection. Expansion and reconnection late 2009, but details are unclear.  
TeUku                                                                                                                                                                                                      Wind farm. 28�2�3 = 64�4MW.  
WeldCone                                                                                                                                                                                                    Wind farm. 3�250KW = 750KW  
WhiteHill                                                                                                                                                                                                  Wind farm. 29�2MW for 58MW.  
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
Nominal_Totals = DataFrame({'Hydro':NP_MW.filter(like='Hydro').sum(axis=1)/1000.0,'Thermal':NP_MW.filter(like='Thermal').sum(axis=1)/1000.0,'Geothermal':NP_MW.filter(like='Geothermal').sum(axis=1)/1000.0,'Wind':NP_MW.filter(like='Wind').sum(axis=1)/1000.0})
Nominal_Totals = Nominal_Totals.fillna(0)
Nominal_Totals.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
            Geothermal  Hydro  Thermal  Wind
1886-02-03           0   0.05        0     0
1887-01-01           0   0.00        0     0
1887-06-01           0   0.06        0     0
1888-08-01           0   0.08        0     0
1889-06-01           0   0.14        0     0
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def fillplot(d,ylimits,ylabeltext,titletext,fig,ax):
    plot(d.index,d.Wind,color = ea_s['gn1'],label='Wind')
    plot(d.index,d.Wind+d.Geothermal,color=ea_p['yl1'],label='Geothermal')
    plot(d.index,d.Wind+d.Geothermal+d.Thermal,color = ea_p['rd1'],label='Thermal')
    plot(d.index,d.Wind+d.Geothermal+d.Thermal+d.Hydro, color=ea_p['bl1'],label='Hydro')

    fill_between(d.index,d.Wind,0,color = ea_s['gn1'])
    fill_between(d.index,d.Wind,(d.Wind+d.Geothermal),color=ea_p['yl1'])
    fill_between(d.index,(d.Wind+d.Geothermal),(d.Wind+d.Geothermal+d.Thermal),color = ea_p['rd1'])
    fill_between(d.index,(d.Wind+d.Geothermal+d.Thermal),(d.Wind+d.Geothermal+d.Thermal+d.Hydro), color=ea_p['bl1'])
    ylim(ylimits)
    ylabel(ylabeltext,fontsize=20)
    title(titletext,fontsize=20)
    plt.legend(prop={'size':15},loc=2)    
    ax.grid('on')
    plt.tick_params(axis='x', which='major', labelsize=15)
    plt.tick_params(axis='y', which='major', labelsize=15) 
   

yearend='1948'
fig = plt.figure(1,figsize=[25,10])
ax1=fig.add_subplot(121)
fillplot(Nominal_Totals.ix[:yearend],[0,1000],'MW','Growth in NZ generation capacity - 1',fig,ax1)

yearstart='1948'
ax2=fig.add_subplot(122)
fillplot(Nominal_Totals.ix[yearstart:],[0,10000],'MW','Growth in NZ generation capacity - 2',fig,ax2)


\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
/usr/local/lib/python2.7/dist-packages/matplotlib-1.3.x-py2.7-linux-x86_64.egg/matplotlib/font_manager.py:1224: UserWarning: findfont: Font family ['ariel'] not found. Falling back to Bitstream Vera Sans
  (prop.get_family(), self.defaultFamily[fontext]))
\end{verbatim}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_00.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig = plt.figure(1,figsize=[11,10])
ax1=fig.add_subplot(111)
yearstart='1992-12-1'
fillplot(Nominal_Totals.ix[yearstart:],[0,10000],'MW','Last 20 years growth in NZ generation capacity',fig,ax1)


\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_01.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig = plt.figure(1,figsize=[25,10])
ax=fig.add_subplot(111)
x=100*(Nominal_Totals/Nominal_Totals.sum(axis=1))
fillplot(x,[0,100],'%','Percentage Generation capacity (by namplate capacity)',fig,ax)


\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
/usr/local/lib/python2.7/dist-packages/pandas-0.11.0.dev_7b58f1d-py2.7-linux-x86_64.egg/pandas/core/frame.py:3582: FutureWarning: TimeSeries broadcasting along DataFrame index by default is deprecated. Please use DataFrame.<op> to explicitly broadcast arithmetic operations along the index
  FutureWarning)
\end{verbatim}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_02.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
%http://en.wikipedia.org/wiki/Horahora_Power_Station    
\section{Home energy monitoring}
The name-plate data set used in the previous section contained just 470 lines of text which was parsed into memory using the python programming language.  In contrast to this, this section looks at the data, collected at the authors home, of total electrical consumption.  In this case, around 5 months of data has been recorded at a 6 second resolution into a database containing over 1.7 million rows.  This is a single reading for a single household.  The increase of smart meters in New Zealand means many such datasets must exist.   Through analsis of the data, holders of such data should be able to benefit from its use.  For example, one could imagine that in the future, high resolution data such as this could be used to help tailor individual customer tarrif plans.  Perhaps this is already happening to some extent? 

Even without a smart meter, or one without a home network connection, it is relatively straight-forward (with the aid of various internet blogs) for one to set up a low cost house-hold energy monitoring system.  
The system described here consists of:
\begin{enumerate}
\item a low cost computer (a small Linux based computer called a Raspberry Pi); and, 
\item an off-the-shelf energy monitoring kit (in this case, a Current Cost energy monitor with its USB data cable purchased on the cheap off TradeMe for $90.
\end{enumerate}
    
Every 6 seconds the Current Cost logs the energy use at the mains switch-board of the authors home.  This is recorded to a MySQL database running on the Raspberry Pi, from which the data can be downloaded and then analysed. 

The figure below illustrates a typical week of electricity usage of the authors house-hold.  Our house-hold consists of 2 adults, and two young children and so should represent the energy usage of a typical young family living in New Zealand.  Other characteristics of the house-hold include:
\begin{enumerate}
\item electric hot water;
\item solid fuel (wood) burner; 
\item electric oven; 
\item gas hob; 
\item one fridge-freezer and one small chest freezer; 
\item house is located in the wind in Wellington, 230m above sea-level.
\end{enumerate}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
store = HDFStore('/home/humed/Dropbox/EEA/EEA2013/data/cc.h5','r')
voltaire = store['cc']
store.close()
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig=plt.figure(1,figsize=[20,10])
voltaire.power.ix[(1726547-125000):1726547-25000].plot(color=ea_p['br1'])
ylabel('Power (W)',fontsize=20)
xlabel('')
title('Typical house-hold energy use',fontsize=20)
plt.tick_params(axis='x', which='major', labelsize=15)
plt.tick_params(axis='y', which='major', labelsize=15) 
ax.grid('on')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_03.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
During this week the most interesting usage occured on the 1st of April.  This is plotted in the figure below.
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig=plt.figure(1,figsize=[20,10])
voltaire.power['2013-04-01'].plot(color=ea_p['br1'])
ylabel('Power (W)',fontsize=20)
xlabel('')
title('House-hold energy use on 1/4/2013',fontsize=20)
plt.tick_params(axis='x', which='major', labelsize=15)
plt.tick_params(axis='y', which='major', labelsize=15) 

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_04.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
During the evening period the blips have the characteristic of an induction motor switching on.  In several instances the inductive inrush current can be observed as a spike.  These blips are caused by the fridge and freezer loads.  On this day it appears the washing machine was switched on just prior to the 3pm School pickup, the kids had a bath before dinner and the oven was turned on just prior to 6pm to cook a lovely quiche! 

In terms of the demand profile, it is interesting to observe how our demand compares with the average demand for our region.  This sort of analysis could help retailers in the future profile custormers demand patterns and use this information to inform appropriate tarrifs or for other competitive advantages perhaps.  Figure X illustrates the mean daily profile of the authors home, compaired with the mead daily profile of the closest GXP (Wilton) which supplies the region. 
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
DWMD = pyodbc.connect('DSN=DWMarketData;UID=linux_user;PWD=linux')
wilton = sql.read_frame("""SELECT * from com.FP_Demand where Trading_Date>'2012-11-03' and Trading_Date<'2013-04-06' and pnode='WIL0331'""", DWMD)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def DTTM_ID_to_datetime(x): #this does not take into account daylight savings!!!
    x=str(int(x))
    return datetime(int(x[0:4]),int(x[4:6]),int(x[6:8]),int(x[8:10]),int(x[10:]))

def combine_date_time(df):
    return datetime.combine(df['Trading_Date'],df['time'])

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#wilton['Datetime']=wilton.DTTM_ID.map(lambda x: DTTM_ID_to_datetime(x))
wilton['time'] = wilton.Trading_Period.map(lambda x: (datetime.min + timedelta(0,int((x-1)*30*60+15*60),0)).time())
wilton.Trading_Date=wilton.Trading_Date.map(lambda x: datetime(int(x.split('-')[0]),int(x.split('-')[1]),int(x.split('-')[2])))
wilton['Datetime']=wilton.apply(combine_date_time,axis=1)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig=plt.figure(1,figsize=[15,12])
ax=fig.add_subplot(111)
voltaire.power.groupby(voltaire.index.map(lambda x: x.hour)).mean().plot(ax=ax,color=ea_p['bl1'],linewidth=2,label='Home')
ylabel('Power (W)',fontsize=20)
plt.tick_params(axis='both', which='major', labelsize=15)
legend()

wilton.groupby(wilton.Datetime.map(lambda x: x.hour)).mean().FP_Demand.plot(secondary_y=True, style='r',ax=ax,color=ea_p['rd1'],linewidth=2,label='Wilton GXP')
xlim([0,23])
ax.set_xticks(arange(0,24))
ax.grid('on')
ylabel('Wilton 33kV demand (MW)',fontsize=20)
xlabel('Hour',fontsize=20)
title('House-hold average demand profile',fontsize=20)
plt.tick_params(axis='both', which='major', labelsize=15)


\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_05.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
One could deduce from this that the occupants of this home tend to sleep in!  The morning peak electricity usage has a clear lag of 1 hour compared with the regional demand (the Wilton 33kV GXP).  Additionally, there is a clear after school/dinner peak.   The author is a little unclear of the cause of the bump at 10pm. This may be caused by hot-water and running the dishwasher.  

%A boxplot of the hourly usage pattern is also illustrated.


\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#vpower=voltaire.power.groupby([voltaire.index.map(lambda x: x.date()),voltaire.index.map(lambda x: x.hour)]).mean()
#vpower=DataFrame({'power':vpower})
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#fig=plt.figure(1,figsize=[20,12])
#ax=fig.add_subplot(111)
#bp = vpower.boxplot(column='power',by=vpower.index.map(lambda x: x[1]),ax=ax)
#ax.grid('on')
#ylabel('Power (W)',fontsize=15)
#xlabel('Hour',fontsize=15)
#title('House-hold average demand profile',fontsize=20)
#suptitle('')
#plt.tick_params(axis='both', which='major', labelsize=12)

\end{lstlisting}
\end{codeinput}
\end{codecell}
\section{Real-time spot market price monitoring}
The market performace team at the Electricity Authority has a role to play in monitoring the market.  As a tiny part of this, an automatic realtime price monitor system has been set up using the python programming language.  Currently, every 5 minutes the system does the following:
\begin{enumerate}
\item FTPs the WITS FTP server and downloads the most recent 5 minute prices;
\item parses the data into memory; 
\item adds the data to an ad-hoc database; 
\item generates various statistics, including max/min gxps and average regional prices; 
\item interactively plots price trends at all GXPs for the last week using a javascript enabled web-browser; 
\item sends SMS alert text messages under certain conditions.
\end{enumerate}

The figure below illustrates the price monitor in action, in this case prices in the Hawkes Bay region for the Week ending 11am Thursday the 11th of April, 2013 are shown. The picture uses a concept called horizon charts which are able, with the help of contrast, to plot time-series data in a confined space (footnote: this uses a Javascript library call d3.js along with a module called cubism.js developed by Mike Bostock and freely avialble on-line.).  This tpye of visualisation is ideal for monitoring large data sets.  In the case of the NZ electricty market, all prices over the 250+ GXP's for the past week can be inspected within a matter of seconds.  The bands of decreasing constrast indicated increasing prices, until a threshold is reached where the colour switches from shades of green to red.  Here, at 7:10pm on the Monday the 5th of April, prices reached around $400/MWh at Fernhill in Hawkes Bay (FHL0331).  This was likely caused by a constraint on the network in the region, perhaps in this case the interconnecting transformers at Redcliff.   Clearly, a similar transmission constraint bound, causing high prices on the Wednesday afternoon in the same region. 

Although only one region is illustrated, all regions are available for visualisation.



There are currently issues with real-time prices, not-the-least of which is due to differences that can occur in realtime prices verses final prices.  These differences may be due to a number of factors including inaccurate demand forecasts, generator ramp rates, intermittant generation, among others.  Figure X below illustrates an exmaple of the difference in prices seen in the market over different time frames.  The Non-Responsive and Price-Responsive Schedules (NRS/PRS) indicate the final scheduled prices that were indicated before the trading period started, i.e, they are forward looking or ex-ante prices.  These schedules, along with final prices (which are backward looking, ex-post) are calculated every half-hour, or trading period.  Additionally, there are two 5 minute price series.  The 5 minute ex-post "real-time" price series which is published every 5 minutes, and a forward looking (ex-ante) "distpatch" 5 minute price series that is used by the System Operator and is not published.  The dispatch is solved automatically every 5 minutes, or can be invoked by an operator at any time between. 


\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def combine_date_time(df):
    return datetime.combine(df['Date'],df['hhtime'])
def combine_start_time(df):
    return df['datetime'] + df['dtime']

def get_RTD(datafile):
    dummy_date=datetime(2013,1,1,0,0)
    def combine_date_time(df):
        return datetime.combine(df['Actual Date'],df['l5time'])
    RTD = ExcelFile('../data/' + datafile)
    RTD = RTD.parse('published prices 2',skiprows=2)
    RTD['l5time'] = RTD['Case Name'].map(lambda x: (datetime(2013,1,1,0,0) + timedelta(hours=int(x.split(' ')[3].split(':')[0]),minutes=int(x.split(' ')[3].split(':')[1]))).time())
    RTD['datetime'] = RTD.apply(combine_date_time,axis=1)
    RTD = RTD.set_index('datetime')
    return RTD

def plot_price_year_in_review(data,num,ylimit,filenametext):
    ax=[]
    ea_brown = ((84/255.0),(0/255.0),(0/255.0))
    ea_orange = ((255/255.0),(123/255.0),(0/255.0))
    ea_blue = ((15/255.0),(123/255.0),(175/255.0))
    
    hfmt = dates.DateFormatter('%m/%d %H:%M')

    fig = plt.figure(num=num,figsize = [30,10])
   
    ax = fig.add_subplot(111)
    #Plot the half-hourly Non-Responsive Schedule price (NRS ex-ante)
    ax.plot(data.DateOrdinal[data.NRSS.notnull()],data.NRSS[data.NRSS.notnull()],color = ea_blue,label='NRS',drawstyle='steps-post',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data.NRSS.notnull()],data.NRSS[data.NRSS.notnull()],'>',markerfacecolor= ea_blue,ms=15)
    #Plot the half-hourly Price-Responsive Schedule price (PRS ex-ante)
    ax.plot(data.DateOrdinal[data.PRSS.notnull()],data.PRSS[data.PRSS.notnull()],color = ea_orange,label='PRS',drawstyle='steps-post',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data.PRSS.notnull()],data.PRSS[data.PRSS.notnull()],'>',markerfacecolor= ea_orange,ms=15)
    #Plot the half-hourly Final Price (ex-post)
    ax.plot(data.DateOrdinal[data['Final pricing'].notnull()],data['Final pricing'][data['Final pricing'].notnull()],color = ea_brown,label='FINAL',drawstyle='steps-pre',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data['Final pricing'].notnull()],data['Final pricing'][data['Final pricing'].notnull()],'<',markerfacecolor=ea_brown,ms=15)
    ax.set_xlabel('Trading Period',fontsize=30)
    ax.set_ylabel('$/MWh',fontsize=30)
    ax.set_ylim([0,ylimit]) 
    plt.legend(prop={'size':30})
    #xticks(unique(data['Trading Period'][data['Trading Period'].notnull()][3::6].values))
    #crap code to sort index out to TPs
    #rng = date_range(data.index[0]+timedelta(minutes=15),data.index[-1], freq='30T')
    print data.index #[0],data.index[-1]
    rng = date_range(data.index[0],data.index[-1], freq='30T')
    xticks([m for m in rng],range(31,45))
    #print rng[0]-timedelta(minutes=15)
    xlim([rng[0]-timedelta(minutes=5),rng[-1]+timedelta(minutes=5)])   
    labs=get(ax,'xticklabels')
    #change position of first label  #THIS DOES NOT WORK!!
    #pos=get(labs[0],'position')
    #print pos
    #posnew=(pos[1]+100000, 0)
    #setp(labs[0],position=posnew)
    ax.xaxis.grid(True, which='minor')
    ax.grid('on')
    plt.tick_params(axis='x', which='major', labelsize=25)
    plt.tick_params(axis='y', which='major', labelsize=25)    
    plt.subplots_adjust(bottom=.15)
    #savefig(filenametext + '.png', bbox_inches='tight')
def plot_price1(data,num,ylimit):
    ax=[]
    ea_brown = ((84/255.0),(0/255.0),(0/255.0))
    ea_orange = ((255/255.0),(123/255.0),(0/255.0))
    ea_blue = ((15/255.0),(123/255.0),(175/255.0))
    
    hfmt = dates.DateFormatter('%m/%d %H:%M')

    fig = plt.figure(num=num,figsize = [24,10])
    

    ax = fig.add_subplot(111)
    #Plot the Real time 5 minute price (RTP ex-post)
    ax.plot(data.DateOrdinal[data.FiveMin.notnull()],data.FiveMin[data.FiveMin.notnull()],'k', label='RTP',drawstyle='steps-pre',ls='dashed',lw=1)
    ax.plot(data.DateOrdinal[data.FiveMin.notnull()],data.FiveMin[data.FiveMin.notnull()],'k<')
    #Plot the Real time 5 minute dispatch price (RTD ex-ante)
    ax.plot(data.DateOrdinal[data.Price.notnull()],data.Price[data.Price.notnull()],'r', label='RTD',drawstyle='steps-post',ls='dashed',lw=1)
    ax.plot(data.DateOrdinal[data.Price.notnull()],data.Price[data.Price.notnull()],'r>')
    
    #Plot the half-hourly Non-Responsive Schedule price (NRS ex-ante)
    ax.plot(data.DateOrdinal[data.NRSS.notnull()],data.NRSS[data.NRSS.notnull()],color = ea_blue,label='NRS',drawstyle='steps-post',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data.NRSS.notnull()],data.NRSS[data.NRSS.notnull()],'>',markerfacecolor= ea_blue,ms=15)
    #Plot the half-hourly Price-Responsive Schedule price (PRS ex-ante)
    ax.plot(data.DateOrdinal[data.PRSS.notnull()],data.PRSS[data.PRSS.notnull()],color = ea_orange,label='PRS',drawstyle='steps-post',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data.PRSS.notnull()],data.PRSS[data.PRSS.notnull()],'>',markerfacecolor= ea_orange,ms=15)
    #Plot the half-hourly Final Price (ex-post)
    ax.plot(data.DateOrdinal[data['Final pricing'].notnull()],data['Final pricing'][data['Final pricing'].notnull()],color = ea_brown,label='FINAL',drawstyle='steps-pre',lw=4,alpha=0.85)
    ax.plot(data.DateOrdinal[data['Final pricing'].notnull()],data['Final pricing'][data['Final pricing'].notnull()],'<',markerfacecolor=ea_brown,ms=15)
    ax.set_xlabel('Trading Period',fontsize=30)
    ax.set_ylabel('$/MWh',fontsize=30)
    ax.set_ylim([0,ylimit]) 
    plt.legend(prop={'size':20})

    ax.set_ylim([0,ylimit]) 
        
    if True:
       hhx = 1/48.0 
       l5x = 1/(48.0*6.0) 
       majorLocator   = MultipleLocator(hhx)
       majorFormatter = FormatStrFormatter('%d')
       minorLocator   = MultipleLocator(l5x)
       ax.xaxis.set_major_locator(majorLocator)
       ax.xaxis.set_major_formatter(dates.DateFormatter('%m/%d %H:%M'))

       #for the minor ticks, use no labels; default NullFormatter
       ax.xaxis.set_minor_locator(minorLocator)
       plt.xticks(rotation='vertical')
       ax.xaxis.grid(True, which='minor')
       ax.grid('on')
    
    plt.subplots_adjust(bottom=.15)
    plt.tick_params(axis='both', which='major', labelsize=16)

    
parts = ExcelFile('../data/Pricing ideas.xlsx')
#parts = parts.parse('Data',parse_cols=[2,3],index_col=[0])
parts = parts.parse('Data')
parts.TP = parts.TP.map(lambda x: int(x)) 
parts['hhtime']=parts.TP.map(lambda x: (datetime(2013,1,1,0,0) + timedelta(0,(int(x)-1)*30*60,0)).time()) #Work out the time from the HH number
parts['dtime'] = parts.FiveMin.map(lambda x: timedelta(minutes=x))
parts['datetime'] = parts.apply(combine_date_time,axis=1) 
parts['l5time'] =parts.apply(combine_start_time,axis=1) 
#parts.l5time = parts.Time + parts.dtime
#Gin['Aux_HHtime']=Gin['Aux_HHn'].map(lambda x: timedelta(0,(x-1)*30*60+15*60,0)) #Work out the time from the HH number
#parts = parts.rename(columns={' Associated name.':'Name'})
#parts = parts.Name.to_dict()
parts2 = pivot_table(parts, values='Price', rows=['l5time'], cols=['Schedule'])


RTD1 = get_RTD('05Aug2012.xls')
RTD2 = get_RTD('08Aug2012.xls')
RTD3 = get_RTD('15Aug2012.xls')
RTD = concat([RTD1,RTD2,RTD3,parts2])
RTD = RTD.sort_index()
RTD['DateOrdinal'] = RTD.index.map(lambda x: date2num(x))

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
Data!$A:$L False
#N/A False
#N/A False
NOTE *** Ignoring non-worksheet data named u'Macro1' (type 0x01 = Macro sheet)
\end{verbatim}
\begin{verbatim}
NOTE *** Ignoring non-worksheet data named u'Macro1' (type 0x01 = Macro sheet)
NOTE *** Ignoring non-worksheet data named u'Macro1' (type 0x01 = Macro sheet)
\end{verbatim}
\begin{verbatim}

\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#RTD05AUG = RTD[(RTD.index.day==5) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price_year_in_review(RTD05AUG,1,520,'PRS_NRS_FINAL_05AUG2012')

#RTD08AUG = RTD[(RTD.index.day==8) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price_year_in_review(RTD08AUG,2,400,'PRS_NRS_FINAL_08AUG2012')

#RTD15AUG = RTD[(RTD.index.day==15) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price_year_in_review(RTD15AUG,3,2500,'PRS_NRS_FINAL_15AUG2012')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#RTD05AUG = RTD[(RTD.index.day==5) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price1(RTD05AUG,1,520)

#RTD08AUG = RTD[(RTD.index.day==8) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price1(RTD08AUG,2,400)

#RTD15AUG = RTD[(RTD.index.day==15) & (RTD.index.hour>14.99) & (RTD.index.hour<21.01)]
#plot_price1(RTD15AUG,3,2500)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
RTD15AUG = RTD[(RTD.index.day==15) & (RTD.index.hour>3.99) & (RTD.index.hour<9.01)]
plot_price1(RTD15AUG,3,160)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_06.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\section{Transmission unplanned outage data}
As part of the CDS, Transpower provides two excel files that list, in cronological order, forced outages of Transpower's assets.  One file contains AC transmission outages, while the other contains unplanned HVDC system outages.   Each transmission forced asset outage has a unique identifier along with a code that describes the actual equipment that was removed from serive.  This is called the primary outage.  Associated with each primary outage is a list of additional secondary outages that were removed as a result of the primary outage.  This section takes a brief look at the HVAC outages on Transpowers network.  

The table below illustrates a slightly altered form of the data.
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def combine_date_time(df):
    return datetime.combine(df['Date'],df['Time'])
def combine_start_time(df):
    return df['Start'] + df['Duration']

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac = ExcelFile('../data/HVAC_forced_outages_data_1999_Jun2012.xls')
hvdc = ExcelFile('../data/HVDC_forced_outages_data_1999_Jun2012.xls')
hvac = hvac.parse(sheetname='HVAC',na_values=['.'])

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['Time'] = hvac['Time'].map(lambda x: time(int(str(int(x)).zfill(4)[0:2]),int(str(int(x)).zfill(4)[2:4])))
hvac['DateTime'] = hvac.apply(combine_date_time,axis=1)
hvac =hvac.rename(columns={'DateTime':'Start'})
hvac.Duration = hvac.Duration.fillna(0).map(lambda x: timedelta(minutes=x))
hvac['End'] = hvac.apply(combine_start_time,axis=1)

hvac.head()
del hvac['Duration']
hvac=hvac.replace(u' ',nan).fillna(method='pad')
hvac['Duration'] = hvac['End']-hvac['Start']
hvac=hvac.set_index(['Ident','Flt_Item','Rem_Item'])
hvac.head(10)
#Add Island indicators
hvac['Island'] = hvac.index.map(lambda x: x[0][1])
del hvac['Date']
del hvac['Time']
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head(13)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
                                                Start                 End  \
Ident   Flt_Item     Rem_Item                                               
SS99101 LIV-NSY1     LIV-NSY1     1999-07-02 11:20:00 1999-07-02 11:30:00   
                     NSY-TF-1     1999-07-02 11:20:00 1999-07-02 11:40:00   
                     NSY-TF-2     1999-07-02 11:20:00 1999-07-02 11:41:00   
                     NSY-ROX1     1999-07-02 11:20:00 1999-07-02 11:30:00   
SS99102 CML-FKN2     CML-FKN2     1999-07-02 22:13:00 1999-07-02 22:36:00   
                     FKN-TF-4     1999-07-02 22:13:00 1999-07-02 22:38:00   
SS99103 CML-FKN2     CML-FKN2     1999-07-02 22:50:00 1999-07-02 23:00:00   
                     FKN-TF-4     1999-07-02 22:50:00 1999-07-02 23:16:00   
SS99104 CML-FKN1     CML-FKN1     1999-07-02 23:04:00 1999-07-02 23:11:00   
                     FKN-TF-2     1999-07-02 23:04:00 1999-07-02 23:12:00   
SS99105 CML-FKN2     CML-FKN2     1999-07-02 23:09:00 1999-07-03 16:27:00   
                     FKN-TF-4     1999-07-02 23:09:00 1999-07-03 16:27:00   
SN99149 OPK-KPI-SFD2 OPK-KPI-SFD2 1999-07-03 01:43:00 1999-07-03 01:43:00   

                                   Duration Island  
Ident   Flt_Item     Rem_Item                       
SS99101 LIV-NSY1     LIV-NSY1       0:10:00      S  
                     NSY-TF-1       0:20:00      S  
                     NSY-TF-2       0:21:00      S  
                     NSY-ROX1       0:10:00      S  
SS99102 CML-FKN2     CML-FKN2       0:23:00      S  
                     FKN-TF-4       0:25:00      S  
SS99103 CML-FKN2     CML-FKN2       0:10:00      S  
                     FKN-TF-4       0:26:00      S  
SS99104 CML-FKN1     CML-FKN1       0:07:00      S  
                     FKN-TF-2       0:08:00      S  
SS99105 CML-FKN2     CML-FKN2      17:18:00      S  
                     FKN-TF-4      17:18:00      S  
SN99149 OPK-KPI-SFD2 OPK-KPI-SFD2   0:00:00      N  
\end{verbatim}
\end{codeoutput}
\end{codecell}
where the fields are:

\begin{description}
\item[Ident:] Incident Identifier that links all the records associated with one fault. Note: the second letter indicates an 'S' for South or 'N' for North Island;
\item[Flt_Item:] The primary forced outage identifier indicating the item of equipment which caused the forced outage. There is usually one of these per incident. The exception is for a double circuit fault;
\item[Rem_Item:] The secondary outages forced out of service caused by the primary outage;
\item[Island:] Indicator of where the outage occurred;
\end{description}

For example, at 11:20am on 2nd of July, 1999, the Livingston-Nasby-Roxburgh circuit tripped also taking out the supply transformers at Naseby.  Although the LIV-NSY-ROX circuit was back in service 10 minutes later, it took 20/21 minutes before the Naseby supply transformers were back in service.  

The following notes are included in the CDS. 
 
\begin{enumerate}
\item Forced Outages are those for which the equipment was tripped or manually taken out of service within 24 hours of the fault occurring or being discovered.
\item A circuit is deemed out of service if any circuit breaker is open. In some cases, a forced outage may be recorded against a circuit section rather than the whole circuit, in particular for three terminal circuits. A transformer is deemed out of service if either the HV or LV circuit breaker is open (an open CB on the tertiary winding is generally not considered to constitute a transformer outage).
\item A trip – autoreclose-trip sequence is shown as one incident (with one identifier) if the autoreclose was unsuccessful because of a persisting fault.
\item If a second fault occurs or is discovered when attempting to return equipment to service, a second incident is recorded with a second identifier, e.g. failed autoreclose because of a protection fault; or a transformer cannot be returned to service because of a CB problem.
\item A number of outages within a relatively short space of time will generally be recorded under one identifier if they all had the same cause, e.g. a tree causes three trippings within 10 minutes. If the outages are caused by separate faults they will have separate identifiers, e.g. if a circuit trips for lightning 3 times in 10 minutes.
\item Unplanned outages caused by a delayed return-to-service after planned maintenance works are not included.
\item Whilst Transpower has used reasonable endeavours to ensure that this data is accurate, there is no guarantee that it is error free.
\end{enumerate}
Lets take a look at the total forced outages per year.  Note: 1999 and 2012 currently have incomplete data.
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#plot counts of flt items per year
#Primary outages, ie, the 'causer' outage 
def total_flt_item_count(data,figno,title_text):
    flt_items_starts = data.reset_index().set_index(['Ident','Flt_Item']).groupby(level=[0,1]).first()
    pri=flt_items_starts.groupby(flt_items_starts.Start.map(lambda x: x.year)).count().Rem_Item
    pri_sec = data.groupby(data.Start.map(lambda x: x.year)).count().Start
    fig=plt.figure(figno,figsize=[15,15])
    ax=fig.add_subplot(211)
    DataFrame({'Primary outage counts':pri,'Primary+Secondary outage counts':pri_sec}).plot(kind='bar',ax=ax,color=[ea_s['or2'],ea_s['or1']])
    title(title_text,fontsize=20)
    grid('on')
    ylabel('Count',fontsize=20)
    xlabel('')
    plt.tick_params(axis='both', which='major', labelsize=16)

    ax2=fig.add_subplot(212)
    (pri_sec-pri).plot(kind='bar',ax=ax2,color=ea_s['og1'])
    title('Secondary outage counts per year',fontsize=20)
    ylabel('Count',fontsize=20)
    xlabel('')
    plt.tick_params(axis='both', which='major', labelsize=16)

    return pri,pri_sec
    print 'Average of %s/%s primary/secondary forced outages per year' % (str(int(pri.mean().round())),str(int(pri_sec.mean().round())))
    
pri,pri_sec = total_flt_item_count(hvac,1,'Total forced outages per year')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_07.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
Figure x indicates that although the total count of primary "causer" faulted items is reasonably static, (with a mean of around 505 events/year), there appears to be an increase in the secondary outages associated with each primary outage.  I.e., it appears that the size of forced outage event is increasing.  To test this hypothesis, additional statistical analysis on the data is required. 
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
import statsmodels.api as sm
def regress(data, yvar, xvars):
    Y = data[yvar]
    X = data[xvars]
    X = sm.add_constant(X)
    result = sm.OLS(Y, X).fit()
    data['fitted']=Series(result.fittedvalues)
    
    return data,result

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
diff_pri_sec = pri_sec-pri
diff_pri_sec[1999]=diff_pri_sec[1999]*2
diff_pri_sec[2012]=diff_pri_sec[2012]*2
diff_pri_sec_counts = DataFrame({'index':range(len(diff_pri_sec)),'year':diff_pri_sec.index,'counts':diff_pri_sec.values})
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
pri[1999]=pri[1999]*2
pri[2012]=pri[2012]*2
pri = DataFrame({'index':range(len(pri)),'year':pri.index,'counts':pri.values})

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
pri_counts,results_pri=regress(pri,'counts','index')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig=plt.figure(1,figsize=[15,10])
ax=fig.add_subplot(111)
plot(pri_counts.year.values,pri_counts.counts.values,color=ea_s['or1'],linewidth=2)
plot(pri_counts.year.values,pri_counts.fitted.values,color=ea_p['br1'],linewidth=2)
xlim([1999,2012])
grid('on')
ylabel('Primary count',fontsize=20)
title('Primary faults trend',fontsize=20)
plt.tick_params(axis='both', which='major', labelsize=16)

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_08.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
results_pri.summary()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
/usr/lib/python2.7/dist-packages/scipy/stats/stats.py:1198: UserWarning: kurtosistest only valid for n>=20 ... continuing anyway, n=14
  int(n))
\end{verbatim}
\begin{verbatim}
<class 'statsmodels.iolib.summary.Summary'>
"""
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 counts   R-squared:                       0.268
Model:                            OLS   Adj. R-squared:                  0.207
Method:                 Least Squares   F-statistic:                     4.403
Date:                Thu, 11 Apr 2013   Prob (F-statistic):             0.0577
Time:                        12:45:40   Log-Likelihood:                -78.224
No. Observations:                  14   AIC:                             160.4
Df Residuals:                      12   BIC:                             161.7
Df Model:                           1                                         
==============================================================================
                 coef    std err          t      P>|t|      [95.0% Conf. Int.]
------------------------------------------------------------------------------
const        442.3143     35.394     12.497      0.000       365.198   519.431
index          9.7099      4.628      2.098      0.058        -0.373    19.792
==============================================================================
Omnibus:                        1.625   Durbin-Watson:                   2.141
Prob(Omnibus):                  0.444   Jarque-Bera (JB):                1.281
Skew:                           0.630   Prob(JB):                        0.527
Kurtosis:                       2.220   Cond. No.                         14.7
==============================================================================
"""
\end{verbatim}
\end{codeoutput}
\end{codecell}
As illustrated, 2006 was a particularly bad year with a maximum of almost 650 forced outages, or, on average, one every 14 hours.  In contrast, 2003 had only 404 primary outages or, on average, one every 22 hours.  The average over the entire data series is 505 outages per year, or one every 17.3 hours.  On visual inspection there appears a concerning upward trend.  However, with such varying data it is often difficult to test this statistically.   One method is to attempt to fit a straight line.  This is achieved using an ordinary least squares, or OLS, linear regression model.  OLS models also output various coefficients and statistical indicators, including measures such as confidence intervals.  In this instance it appears that it is statistically likely (to around a 95\% confidence interval) that the number of primary forced outages over the last 13 years may have, at the very least, been increasing.   On average, the Optimal Least Squares (OLS) regression results indicate a growing number of around 10 forced outages per year. 

These results are borderline conclusive as the P-values indicate (footnote: A p-value is always between 0 and 1 and it tells you the probability of the difference in your data being due to sampling error, the p-value should be lower than a chosen significance level (0.05 for example) before you can reject your null hypothesis.) and so we can't conclusively state that the primary forced outage rate is growing, although it is likely that it is. 

As illustrated in figure x, in addition to total primary forced outages it is interesting to analyse the secondary outage counts per year.  Annual counts of secondary outages provides a very good proxy for the size of the primary forced outage events.  In this instance, the size of any forced outage event is not measured by lost electrical demand, but instead measured by how many additional elements are lost due to the primary causing outage, i.e., the number of additional transformers, circuits or line sections lost when a primary forced outage occurs. 

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
diff_pri_sec_counts,results=regress(diff_pri_sec_counts,'counts','index')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
fig=plt.figure(1,figsize=[15,10])
ax=fig.add_subplot(111)
plot(diff_pri_sec_counts.year.values,diff_pri_sec_counts.counts.values,color=ea_s['og1'],linewidth=2)
plot(diff_pri_sec_counts.year.values,diff_pri_sec_counts.fitted.values,'r',color=ea_p['br1'],linewidth=2)
xlim([1999,2012])
ylabel('Secondary minus Primary count',fontsize=20)
title('Event size: secondary asset outage counts',fontsize=20)
plt.tick_params(axis='both', which='major', labelsize=16)
grid('on')

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=0.7\textwidth]{125_years_of_data_files/125_years_of_data_fig_09.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
results.summary()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'statsmodels.iolib.summary.Summary'>
"""
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 counts   R-squared:                       0.611
Model:                            OLS   Adj. R-squared:                  0.578
Method:                 Least Squares   F-statistic:                     18.83
Date:                Tue, 09 Apr 2013   Prob (F-statistic):           0.000962
Time:                        12:01:37   Log-Likelihood:                -73.147
No. Observations:                  14   AIC:                             150.3
Df Residuals:                      12   BIC:                             151.6
Df Model:                           1                                         
==============================================================================
                 coef    std err          t      P>|t|      [95.0% Conf. Int.]
------------------------------------------------------------------------------
const        145.4571     24.628      5.906      0.000        91.798   199.117
index         13.9736      3.220      4.340      0.001         6.958    20.989
==============================================================================
Omnibus:                       11.111   Durbin-Watson:                   2.908
Prob(Omnibus):                  0.004   Jarque-Bera (JB):                6.867
Skew:                           1.466   Prob(JB):                       0.0323
Kurtosis:                       4.782   Cond. No.                         14.7
==============================================================================
"""
\end{verbatim}
\end{codeoutput}
\end{codecell}
This suggests, with reasonable certainty, that the size of event outages, in terms of the amount of secondary items effected, has been growing.  The 95% confidence interval is between 7 and 21 adiditonal outages per year with an average rate of growth of around 14 additional secondary outages per year, for each year, over the past 13 years. 

Assuming the data is to be believed, there could be many reasons for this increasing trend, including: 
    
\begin{itemize}
\item increased system size;
\item increased peak demand;
\item increased complexity, for example, complex protection systems and settings?
\item increased human error; 
\item data/communication issues?
\item actual reported dataset issues?
\item lack of investment;
\item lack of maintenance; 
\item lack of co-rodination in planned outages? 
\end{itemize}

This section has illustrated the results of an analysis on the forced outage data that is openly published as part of the Centralised Data Set (CDS).  It suggests that primary forced outages may be on the increase, although this is boarderline statistically.  Without a doubt, it appears that the size of forced outages, in terms of the number of secondary outages resulting from an initial primary outage is most cetainly on the increase. 

Many more analyses have and can be made on this dataset.  For example, grouping the data at the island level can give island wide information and we can also identify those assets who trip most often, etc.  If interested, contact the author for more information or for a copy of the IPython Notebook, and data files used in this analysis.
\section{POCP data}
The Planned Outage Co-ordination Process (POCP) and the POCP database are run by the System Operator and provide a voluntary platform through which industry participants can publish, or broadcast, their intended planned generation and transmission outages.

The current system was jointly developed by participants, including Transpower, through a series of joint industry workshops during 2002/2003.  The WAG/System Operator are currently reviewing the POCP process.

The data, although available to participants, is not openly available, requiring registration and a password.  The POCP database is available at: 
    
\url{http://www.pocp.redspider.co.nz/} with a dashboard available at:
\url{http://nzeb.redspider.co.nz/}\footnote{A guide is also avialable at: \url{http://pocp.redspider.co.nz/doc/guide.php}}
        
Under the POCP:
\begin{itemize}
\item Asset owners provide information about their planned outages;
\item The System Operator assesses any potential conflict with its Principle Performance Objectives, based on the information provided, and publishes the results of the assessment;
\item Any interested party may view both the planned outage data, and the results of the System Operator assessments, so that they are aware of planned outages that may require their consideration or action;
\item The POCP database supports the POCP by receiving, collating and publishing the planned outage data from asset owners, and is also used to publish the results of the System Operator assessments.
\end{itemize}

The System Operator provides a very nice dashboard through \url{http://nzeb.redspider.co.nz/} which provides a more graphical interface with custom alerts etc.  This is great for future planning, and outage assessment, as required by the System Operator, but as it turns out, not so great for inspecting historic outages.   The Market Performance team at the Authority are interested in both forward looking and historic outages.   There are several issues with the way the current POCP database is setup:  
\being{description}
\item[Generators often cancel an outage after the outage window has finished]  This makes if difficult to tell, retrospectively, weather an outage actually happened at all.  A way around this is to inspect the Last Modified field and make the assumption that as the outage was modified after the "End time" field, the outage did infact occur.  This is not ideal.  Ideally, outages should never be cancelled if they did infact occur.  Outage's should only be cancelled if they do not occur. If an outage ends early, then the End Time can be modified to reflect this.  
\item[Inconsistant data]  The current database allows generators quite a lot of freedom when entering data.  This is problamatic and makes analysis of the data very difficult.  For example;
        \begin{itemize}
        \item None of Trustpowers generation outages are ever confirmed.  They are all marked as Tentative;
        \item Outages can be entered multiple times with different identifiers;
        \item Outages can be indicated with no MW loss of generation;
        \item Over the history of the data, there are Outages whoses IDs are not unique.
        \end{itemize}
\end{description}
Despite these problems, it is useful to investigate outages as they occur in time by time-serializing the data and constructing a time series of outage MW magnitude.  To get around some of the issues discussed above some ad-hoc time dependent logic is applied, in particular to determine if a cancelled outage did infact occur.  Due to the inconsistancies in the data, there are probably issues with some of the logic used.  However, an output of this time-serilaisation process is illustrated below.  This is an interactive data visualisation that lists the outages started within the selected window.  To achieve this a Python script is used to download the database and manipulate the data into a required form, including the construction of the time series data.  A local webserver is then setup to plot the data using, in this case, the excellent Javascript d3 library combined with a d3 module called "cross-filter".



\section{Open source software}
The development of quality open source software has taken off in recent years due mainly to the ease of software colabaration through the use of the Git version control software and Github.

This paper is writen entirely with open-source, freely availble software.   All data analysis, outputs and in fact the entire text of this paper have been written within a single iPython notebook.  
The iPython notebook allows an interactive python code devleopment environment from within the web-browser.  The Notebook and packages such as Numpy and Pandas have been the authors daily tools now for over 18 months, replacing both Matlab, Excel and R.

The use of client-side (browser based) visualisation for interactivity is also growing extremely quickly.  Javascript/d3 and it's various modules appear to be leading the pack.

\section{Conclusions}

In an industry flush with data, data analysis and visualisation are becoming increasingly important.  The expoential growth in electrical generation in the first half of the 20th centry has in certain ways been replaced by an exponential growth in data.  A single hour of data logging from a single home energy monitoring system will contain more data than the total historical generator name-plate data series used in this paper.  For the engineering/data analyst, it is easy to become engulfed with too much data.  Tools (and knowing how to use them efficiently) are important.  In recent years the rise of powerful open-source software has in ways overtaken many commercial products.  In particular, the Python programming language combined with the iPython notebook make for a formidable interactive workspace, ideal for both data analysis and visualisation.  



\end{document}
