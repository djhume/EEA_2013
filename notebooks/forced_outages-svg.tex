%% This file was auto-generated by IPython, do NOT edit
%% Conversion from the original notebook file:
%% forced_outages-svg.ipynb
%%
\documentclass[11pt,english]{article}

%% This is the automatic preamble used by IPython.  Note that it does *not*
%% include a documentclass declaration, that is added at runtime to the overall
%% document.

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{ucs}
\usepackage[utf8x]{inputenc}

% needed for markdown enumerations to work
\usepackage{enumerate}

% Slightly bigger margins than the latex defaults
\usepackage{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=2.5cm,rmargin=2.5cm}

% Define a few colors for use in code, links and cell shading
\usepackage{color}
\definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
\definecolor{darkorange}{rgb}{.71,0.21,0.01}
\definecolor{darkgreen}{rgb}{.12,.54,.11}
\definecolor{myteal}{rgb}{.26, .44, .56}
\definecolor{gray}{gray}{0.45}
\definecolor{lightgray}{gray}{.95}
\definecolor{mediumgray}{gray}{.8}
\definecolor{inputbackground}{rgb}{.95, .95, .85}
\definecolor{outputbackground}{rgb}{.95, .95, .95}
\definecolor{traceback}{rgb}{1, .95, .95}

% Framed environments for code cells (inputs, outputs, errors, ...).  The
% various uses of \unskip (or not) at the end were fine-tuned by hand, so don't
% randomly change them unless you're sure of the effect it will have.
\usepackage{framed}

% remove extraneous vertical space in boxes
\setlength\fboxsep{0pt}

% codecell is the whole input+output set of blocks that a Code cell can
% generate.

% TODO: unfortunately, it seems that using a framed codecell environment breaks
% the ability of the frames inside of it to be broken across pages.  This
% causes at least the problem of having lots of empty space at the bottom of
% pages as new frames are moved to the next page, and if a single frame is too
% long to fit on a page, will completely stop latex from compiling the
% document.  So unless we figure out a solution to this, we'll have to instead
% leave the codecell env. as empty.  I'm keeping the original codecell
% definition here (a thin vertical bar) for reference, in case we find a
% solution to the page break issue.

%% \newenvironment{codecell}{%
%%     \def\FrameCommand{\color{mediumgray} \vrule width 1pt \hspace{5pt}}%
%%    \MakeFramed{\vspace{-0.5em}}}
%%  {\unskip\endMakeFramed}

% For now, make this a no-op...
\newenvironment{codecell}{}

 \newenvironment{codeinput}{%
   \def\FrameCommand{\colorbox{inputbackground}}%
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\unskip\endMakeFramed}

\newenvironment{codeoutput}{%
   \def\FrameCommand{\colorbox{outputbackground}}%
   \vspace{-1.4em}
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\unskip\medskip\endMakeFramed}

\newenvironment{traceback}{%
   \def\FrameCommand{\colorbox{traceback}}%
   \MakeFramed{\advance\hsize-\width \FrameRestore}}
 {\endMakeFramed}

% Use and configure listings package for nicely formatted code
\usepackage{listingsutf8}
\lstset{
  language=python,
  inputencoding=utf8x,
  extendedchars=\true,
  aboveskip=\smallskipamount,
  belowskip=\smallskipamount,
  xleftmargin=2mm,
  breaklines=true,
  basicstyle=\small \ttfamily,
  showstringspaces=false,
  keywordstyle=\color{blue}\bfseries,
  commentstyle=\color{myteal},
  stringstyle=\color{darkgreen},
  identifierstyle=\color{darkorange},
  columns=fullflexible,  % tighter character kerning, like verb
}

% The hyperref package gives us a pdf with properly built
% internal navigation ('pdf bookmarks' for the table of contents,
% internal cross-reference links, web links for URLs, etc.)
\usepackage{hyperref}
\hypersetup{
  breaklinks=true,  % so long urls are correctly broken across lines
  colorlinks=true,
  urlcolor=blue,
  linkcolor=darkorange,
  citecolor=darkgreen,
  }

% hardcode size of all verbatim environments to be a bit smaller
\makeatletter 
\g@addto@macro\@verbatim\small\topsep=0.5em\partopsep=0pt
\makeatother 

% Prevent overflowing lines due to urls and other hard-to-break entities.
\sloppy

\begin{document}

\section{Transpower forced outage data}
\subsection{Data for Centralised Data System --
Enduring Forced Asset Outages}
HVAC

The data is provided as an Excel file and is a list of forced outages of
Transpower transmission circuits, transformers, capacitor banks,
synchronous Condensers, and the Islington SVC.

The fields are:

Ident: Incident Identifier that links all the records associated with
one fault.
Flt\_Item: The item / equipment causing the forced outage. There is
usually one of these per incident. The exception is for a double circuit
fault.
Rem\_Item: Any equipment in the above categories that has been forced
out of service.
Date Time: Date Time: Date, Time
Duration: Outage Duration in minutes.
Notes:

Forced Outages are those for which the equipment was tripped or manually
taken out of service within 24 hours of the fault occurring or being
discovered.
A circuit is deemed out of service if any circuit breaker is open. In
some cases, a forced outage may be recorded against a circuit section
rather than the whole circuit, in particular for three terminal
circuits. A transformer is deemed out of service if either the HV or LV
circuit breaker is open (an open CB on the tertiary winding is generally
not considered to constitute a transformer outage).
A trip -- autoreclose-trip sequence is shown as one incident (with one
identifier) if the autoreclose was unsuccessful because of a persisting
fault.
If a second fault occurs or is discovered when attempting to return
equipment to service, a second incident is recorded with a second
identifier, e.g.~failed autoreclose because of a protection fault; or a
transformer cannot be returned to service because of a CB problem.
A number of outages within a relatively short space of time will
generally be recorded under one identifier if they all had the same
cause, e.g.~a tree causes three trippings within 10 minutes. If the
outages are caused by separate faults they will have separate
identifiers, e.g.~if a circuit trips for lightning 3 times in 10
minutes.
Unplanned outages caused by a delayed return-to-service after planned
maintenance works are not included.
Whilst Transpower has used reasonable endeavours to ensure that this
data is accurate, there is no guarantee that it is error free.
HVDC

The data is provided as an Excel file and is a list of forced outages on
Transpower's HVDC system.

The fields are:
Occurrence: Date and Time of tripping.
RTS\_Date: Date and Time of return to service.
Terminal: Equipment affected
Notes:

HVDC Forced outages include both automatic and manual trippings. An HVDC
outage is categorised as forced if it occurs within 7 days of a fault
being discovered. System disturbances and restrictions are not included.

Whilst Transpower has used reasonable endeavours to ensure that this
data is accurate, there is no guarantee that it is error free.

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
import os
path='/home/humed/python/notebooks'
#os.listdir(path)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
from pandas import *
import pandas
%config InlineBackend.figure_format = 'svg'
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac = ExcelFile('HVAC_forced_outages_data_1999_Jun2012.xls')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac = hvac.parse(sheetname='HVAC',na_values=['.'])
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.tail(100)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
        Ident            Flt_Item                 Date  Time          Rem_Item  Duration
9546  SN12206                      2012-05-29 00:00:00  1608          KIN-LFD2        90
9547  SN12206                      2012-05-29 00:00:00  1608          OKE-OWH1        87
9548  SN12208            OTA-WKM1  2012-05-30 00:00:00  1230          OTA-WKM1         0
9549  SN12209            ARI-KIN1  2012-05-31 00:00:00  1357          ARI-KIN1       158
9550  SN12210            RDF-TF-1  2012-05-31 00:00:00  2019          RDF-TF-1        93
9551  SS12074             ADD HEI  2012-06-01 00:00:00   154          ADD-TF-7        46
9552  SS12076            ADD-TF-3  2012-06-01 00:00:00   839          ADD-TF-3      1717
9553  SN12212        KIN-LFD-TRK1  2012-06-01 00:00:00  1347      KIN-LFD-TRK1         0
9554  SN12213          ROT-DS-366  2012-06-01 00:00:00  2014          ROT-TF-5        42
9555  SN12213                      2012-06-01 00:00:00  2038          ROT-TRK1         4
9556  SN12214            EDG-KAW2  2012-06-02 00:00:00  1416          EDG-KAW2       199
9557  SN12215            OTA-WKM2  2012-06-02 00:00:00  1941          OTA-WKM2         0
9558  SN12216            FHL-TUI1  2012-06-04 00:00:00  1705          FHL-TUI1         0
9559  SN12217            GIS-TUI1  2012-06-05 00:00:00  1357          GIS-TUI1         0
9560  SN12218            TKH-WAI1  2012-06-05 00:00:00  1549          TKH-WAI1         0
9561  SN12218                      2012-06-05 00:00:00  1549          WAI-TF-5         0
9562  SN12219            TKH-WAI1  2012-06-05 00:00:00  1953          TKH-WAI1         0
9563  SN12219                      2012-06-05 00:00:00  1953          WAI-TF-5         0
9564  SN12220            TKH-WAI1  2012-06-05 00:00:00  2229          TKH-WAI1       708
9565  SN12220                      2012-06-05 00:00:00  2229          WAI-TF-5       708
9566  SN12222            GFD-HAY1  2012-06-06 00:00:00   354          GFD-HAY1       566
9567  SN12222                      2012-06-06 00:00:00   354          GFD-TF-6       567
9568  SS12078            COL-OTI2  2012-06-06 00:00:00   752          COL-OTI2         0
9569  SS12079            ISL-KIK1  2012-06-06 00:00:00   826          ISL-KIK1         0
9570  SS12080            ISL-KIK1  2012-06-06 00:00:00   832          ISL-KIK1         0
9571  SS12080                      2012-06-06 00:00:00   832          ISL-KIK1        63
9572  SS12081    ISL-WPR-CUL-KIK2  2012-06-06 00:00:00   909  ISL-WPR-CUL-KIK2        20
9573  SS12081                      2012-06-06 00:00:00   909         CUL-TF-22        21
9574  SS12081                      2012-06-06 00:00:00   909         WPR-TF-12        21
9575  SS12082    ISL-WPR-CUL-KIK3  2012-06-06 00:00:00   948  ISL-WPR-CUL-KIK3         8
9576  SS12082                      2012-06-06 00:00:00   948         CUL-TF-23         9
9577  SS12082                      2012-06-06 00:00:00   948         WPR-TF-13        10
9578  SS12083    ISL-WPR-CUL-KIK3  2012-06-06 00:00:00  1125  ISL-WPR-CUL-KIK3         6
9579  SS12083                      2012-06-06 00:00:00  1125         CUL-TF-23         7
9580  SS12083                      2012-06-06 00:00:00  1125         WPR-TF-13         8
9581  SS12084    ISL-WPR-CUL-KIK3  2012-06-06 00:00:00  1136  ISL-WPR-CUL-KIK3         8
9582  SS12084                      2012-06-06 00:00:00  1136         CUL-TF-23         9
9583  SS12084                      2012-06-06 00:00:00  1136         WPR-TF-13         9
9584  SS12085            COL-OTI2  2012-06-06 00:00:00  1136          COL-OTI2         7
9585  SS12085    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1136  COL-CLH-APS-OTI1         0
9586  SS12086            COL-HOR2  2012-06-06 00:00:00  1152          COL-HOR2        10
9587  SS12087    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1216  COL-CLH-APS-OTI1         0
9588  SS12088    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1229  COL-CLH-APS-OTI1         6
9589  SS12089            COL-OTI2  2012-06-06 00:00:00  1304          COL-OTI2         0
9590  SS12089    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1304  COL-CLH-APS-OTI1         0
9591  SS12090    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1311  COL-CLH-APS-OTI1         3
9592  SS12091    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1316  COL-CLH-APS-OTI1         0
9593  SS12092    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1317  COL-CLH-APS-OTI1       143
9594  SS12093            HOR-ISL1  2012-06-06 00:00:00  1403          HOR-ISL1         6
9595  SN12223        WRK-PPI-WKM1  2012-06-06 00:00:00  1426      WRK-PPI-WKM1         0
9596  SS12094            HOR-ISL2  2012-06-06 00:00:00  1433          HOR-ISL2         7
9597  SS12095  ISL Sys_Conditions  2012-06-06 00:00:00  1433         ISL-SVC-3        48
9598  SS12096    ISL-WPR-CUL-KIK3  2012-06-06 00:00:00  1440  ISL-WPR-CUL-KIK3         5
9599  SS12096                      2012-06-06 00:00:00  1440         CUL-TF-23         6
9600  SS12096                      2012-06-06 00:00:00  1440         WPR-TF-13         7
9601  SS12097            COL-HOR3  2012-06-06 00:00:00  1508          COL-HOR3         7
9602  SS12098      KIK Cust_Fault  2012-06-06 00:00:00  1548          KIK-TF-1        22
9603  SS12098                      2012-06-06 00:00:00  1612          KIK-TF-1        12
9604  SS12099    COL-CLH-APS-OTI1  2012-06-06 00:00:00  1601  COL-CLH-APS-OTI1        73
9605  SS12099                      2012-06-06 00:00:00  1714      CLH-APS-OTI1       248
9606  SS12100            CLH-TF-1  2012-06-06 00:00:00  2126          CLH-TF-1      1178
9607  SS12800            APS-CLH1  2012-06-06 00:00:00  2142      APS-CLH-COL1      1153
9608  SS12800            APS-CLH1  2012-06-07 00:00:00  1701          APS-CLH1      2569
9609  SS12101    ISL-WPR-CUL-KIK2  2012-06-07 00:00:00   643  ISL-WPR-CUL-KIK2       507
9610  SS12101                      2012-06-07 00:00:00   643         CUL-TF-22       508
9611  SS12101                      2012-06-07 00:00:00   643         WPR-TF-12       508
9612  SS12102  ISL Sys_Conditions  2012-06-07 00:00:00   644         ISL-SVC-9       153
9613  SN12224            GIS-TUI2  2012-06-07 00:00:00  1415          GIS-TUI2         0
9614  SS12103    ISL-WPR-CUL-KIK2  2012-06-08 00:00:00     0  ISL-WPR-CUL-KIK2       902
9615  SS12103                      2012-06-08 00:00:00     0         CUL-TF-22       903
9616  SS12103                      2012-06-08 00:00:00     0         WPR-TF-12       906
9617  SN12225          WRK-DS-105  2012-06-12 00:00:00  1101          OKI-WRK1       355
9618  SN12227          ALB-CB-702  2012-06-13 00:00:00  1031          ALB-TF-6        43
9619  SN12806            ALB-TF-6  2012-06-13 00:00:00  1114          ALB-TF-6        37
9620  SN12806                      2012-06-13 00:00:00  1708          ALB-TF-6       183
9621  SS12105            ASB-VT-1  2012-06-14 00:00:00  1600          ASB-TF-1     17127
9622  SS12105                      2012-06-14 00:00:00  1600          ASB-TF-3        37
9623  SN12228           KAW-VT-26  2012-06-15 00:00:00   800          KAW-TF-6      4874
9624  SS12106            ADD Prot  2012-06-16 00:00:00   909          ADD-TF-6        47
9625  SS12106                      2012-06-16 00:00:00   909      ADD-MLN-ISL4        42
9626  SS12106                      2012-06-16 00:00:00   909          ADD-ISL2        48
9627  SN12229            DRY Prot  2012-06-16 00:00:00  1207          DRY-GLN2        12
9628  SN12229                      2012-06-16 00:00:00  1800          DRY-GLN2       165
9629  SS12107            NMA Prot  2012-06-18 00:00:00   739          NMA-TF-1       325
9630  SS12108             ADD HEI  2012-06-18 00:00:00  1834          ADD-TF-2        44
9631  SN12230            BPE-HAY2  2012-06-20 00:00:00  1106          BPE-HAY2         0
9632  SN12231            MTR-OKN1  2012-06-22 00:00:00   716          MTR-OKN1         0
9633  SN12232          HEN-CB-292  2012-06-23 00:00:00  1030          HEN-HEP3        60
9634  SN12233            HLY Prot  2012-06-26 00:00:00  2000          HLY-SFD1        35
9635  SS12109        DOB-RFN-IGH2  2012-06-27 00:00:00   659      DOB-RFN-IGH2         0
9636  SS12109                      2012-06-27 00:00:00   659         DOB-TF-11         0
9637  SS12110        DOB-RFN-IGH2  2012-06-27 00:00:00  1000      DOB-RFN-IGH2         0
9638  SS12110                      2012-06-27 00:00:00  1000         DOB-TF-11         0
9639  SS12111        DOB-RFN-IGH2  2012-06-27 00:00:00  1019      DOB-RFN-IGH2         0
9640  SS12111                      2012-06-27 00:00:00  1019         DOB-TF-11         0
9641  SS12112        DOB-RFN-IGH2  2012-06-27 00:00:00  1109      DOB-RFN-IGH2       134
9642  SS12112                      2012-06-27 00:00:00  1109         DOB-TF-11       137
9643  SS12113            HWB-PAL2  2012-06-28 00:00:00   454          HWB-PAL2       651
9644  SS12114            ROX-TMH2  2012-06-28 00:00:00  1555          ROX-TMH2         0
9645  SS12114            ROX-TMH1  2012-06-28 00:00:00  1555          ROX-TMH1       192
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
from datetime import timedelta
hvac['Time'] = hvac['Time'].map(lambda x: timedelta(hours = int(str(int(x)).zfill(4)[0:2]), minutes = int(str(int(x)).zfill(4)[2:])))
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
     Ident  Flt_Item                 Date      Time  Rem_Item  Duration
0  SS99101  LIV-NSY1  1999-07-02 00:00:00  11:20:00  LIV-NSY1        10
1  SS99101            1999-07-02 00:00:00  11:20:00  NSY-TF-1        20
2  SS99101            1999-07-02 00:00:00  11:20:00  NSY-TF-2        21
3  SS99101            1999-07-02 00:00:00  11:20:00  NSY-ROX1        10
4  SS99102  CML-FKN2  1999-07-02 00:00:00  22:13:00  CML-FKN2        23
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['DateTime'] = hvac['Date'] + hvac['Time']

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#del hvac['Date']
del hvac['Time']
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head()

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
     Ident  Flt_Item                 Date  Rem_Item  Duration             DateTime
0  SS99101  LIV-NSY1  1999-07-02 00:00:00  LIV-NSY1        10  1999-07-02 11:20:00
1  SS99101            1999-07-02 00:00:00  NSY-TF-1        20  1999-07-02 11:20:00
2  SS99101            1999-07-02 00:00:00  NSY-TF-2        21  1999-07-02 11:20:00
3  SS99101            1999-07-02 00:00:00  NSY-ROX1        10  1999-07-02 11:20:00
4  SS99102  CML-FKN2  1999-07-02 00:00:00  CML-FKN2        23  1999-07-02 22:13:00
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac =hvac.rename(columns={'DateTime':'Start'})
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
     Ident  Flt_Item                 Date  Rem_Item  Duration                Start
0  SS99101  LIV-NSY1  1999-07-02 00:00:00  LIV-NSY1        10  1999-07-02 11:20:00
1  SS99101            1999-07-02 00:00:00  NSY-TF-1        20  1999-07-02 11:20:00
2  SS99101            1999-07-02 00:00:00  NSY-TF-2        21  1999-07-02 11:20:00
3  SS99101            1999-07-02 00:00:00  NSY-ROX1        10  1999-07-02 11:20:00
4  SS99102  CML-FKN2  1999-07-02 00:00:00  CML-FKN2        23  1999-07-02 22:13:00
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.Duration = hvac.Duration.map(lambda x: timedelta(minutes=x)) 
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{traceback}
\begin{verbatim}
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-44-3c75e160476d> in <module>()
----> 1 hvac.Duration = hvac.Duration.map(lambda x: timedelta(minutes=x))

/usr/local/lib/python2.7/dist-packages/pandas-0.9.1.dev_023b1d4-py2.7-linux-x86_64.egg/pandas/core/series.pyc in map(self, arg, na_action)
   2007             return Series(new_values, index=self.index, name=self.name)
   2008         else:
-> 2009             mapped = map_f(values, arg)
   2010             return Series(mapped, index=self.index, name=self.name)
   2011 

/usr/local/lib/python2.7/dist-packages/pandas-0.9.1.dev_023b1d4-py2.7-linux-x86_64.egg/pandas/lib.so in pandas.lib.map_infer (pandas/src/tseries.c:114879)()

<ipython-input-44-3c75e160476d> in <lambda>(x)
----> 1 hvac.Duration = hvac.Duration.map(lambda x: timedelta(minutes=x))

ValueError: cannot convert float NaN to integer
\end{verbatim}
\end{traceback}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.Duration = hvac.Duration.fillna(0)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.Duration = hvac.Duration.map(lambda x: timedelta(minutes=x)) 
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
     Ident  Flt_Item                 Date  Rem_Item Duration                Start
0  SS99101  LIV-NSY1  1999-07-02 00:00:00  LIV-NSY1  0:10:00  1999-07-02 11:20:00
1  SS99101            1999-07-02 00:00:00  NSY-TF-1  0:20:00  1999-07-02 11:20:00
2  SS99101            1999-07-02 00:00:00  NSY-TF-2  0:21:00  1999-07-02 11:20:00
3  SS99101            1999-07-02 00:00:00  NSY-ROX1  0:10:00  1999-07-02 11:20:00
4  SS99102  CML-FKN2  1999-07-02 00:00:00  CML-FKN2  0:23:00  1999-07-02 22:13:00
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['End'] = hvac.Start+hvac.Duration
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
del hvac['Duration']
hvac.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 5 entries, 0 to 4
Data columns:
Ident       5  non-null values
Flt_Item    5  non-null values
Date        5  non-null values
Rem_Item    5  non-null values
Start       5  non-null values
End         5  non-null values
dtypes: object(6)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac = hvac.fillna(method='pad')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 5 entries, 0 to 4
Data columns:
Ident       5  non-null values
Flt_Item    5  non-null values
Date        5  non-null values
Rem_Item    5  non-null values
Start       5  non-null values
End         5  non-null values
dtypes: object(6)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['Flt_Item'][1]
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
u' '
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac=hvac.replace(u' ',nan)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['Flt_Item'][1]
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
nan
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac = hvac.fillna(method='pad')
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 9646 entries, 0 to 9645
Data columns:
Ident       9646  non-null values
Flt_Item    9646  non-null values
Date        9646  non-null values
Rem_Item    9646  non-null values
Start       9646  non-null values
End         9646  non-null values
dtypes: object(6)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['Flt_Item'][1]
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
u'LIV-NSY1'
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head(10)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 10 entries, 0 to 9
Data columns:
Ident       10  non-null values
Flt_Item    10  non-null values
Date        10  non-null values
Rem_Item    10  non-null values
Start       10  non-null values
End         10  non-null values
dtypes: object(6)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['Delta'] = hvac['End']-hvac['Start']
\end{lstlisting}
\end{codeinput}
\end{codecell}

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac.head(10)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 10 entries, 0 to 9
Data columns:
Ident       10  non-null values
Flt_Item    10  non-null values
Date        10  non-null values
Rem_Item    10  non-null values
Start       10  non-null values
End         10  non-null values
Delta       10  non-null values
dtypes: object(7)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#set multi-index?
hvac_MI=hvac.set_index(['Ident','Flt_Item','Rem_Item'])
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac_MI
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
MultiIndex: 9646 entries, (SS99101, LIV-NSY1, LIV-NSY1) to (SS12114, ROX-TMH1, ROX-TMH1)
Data columns:
Date     9646  non-null values
Start    9646  non-null values
End      9646  non-null values
Delta    9646  non-null values
dtypes: object(4)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac_MI.head(10)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
MultiIndex: 10 entries, (SS99101, LIV-NSY1, LIV-NSY1) to (SS99104, CML-FKN1, FKN-TF-2)
Data columns:
Date     10  non-null values
Start    10  non-null values
End      10  non-null values
Delta    10  non-null values
dtypes: object(4)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
x=hvac_MI.sort(columns=['Delta'],ascending=False)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
x.Delta.head(100)
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
Ident    Flt_Item              Rem_Item   
SS12045  BLN-CAP-4             BLN-CAP-4      69 days, 10:39:00
SS11075  ISL-CB-1422           ISL-CAP-22     69 days, 10:39:00
SS10163  ISL-CB-1422           ISL-CAP-22     69 days, 10:39:00
SS09179  ISL Cable_Conn        ISL-SCM-4      69 days, 10:39:00
SS08168  STK Cable_Conn        STK-CAP-34     69 days, 10:39:00
                               STK-CAP-33     69 days, 10:39:00
SN08250  OTA-CB-972            OTA-CAP-4B     69 days, 10:39:00
SN08159  KWA-TF-2              KWA-TF-2       69 days, 10:39:00
SS07146  ISL-SCM-4             ISL-SCM-4      69 days, 10:39:00
SN07207  ALB-CB-902            ALB-CAP-4A     69 days, 10:39:00
SN07185  OTA-CB-972            OTA-CAP-4B     69 days, 10:39:00
SS07022  ISL-CB-332            ISL-CAP-14     69 days, 10:39:00
SN07006  OTA-DS-974            OTA-CAP-4A     69 days, 10:39:00
                               OTA-CAP-4B     69 days, 10:39:00
SN04310  WIL-TF-3              WIL-TF-3       69 days, 10:39:00
SN04230  OTA-REA-4A            OTA-CAP-4A     69 days, 10:39:00
SN03093  HEN-CB-912            HEN-CAP-5B     69 days, 10:39:00
SS03048  STK-TF-9              STK-TF-9       69 days, 10:39:00
SS02076  ISL-SCM-5             ISL-SCM-5      69 days, 10:39:00
SS01139  ISL-SCM-4             ISL-SCM-4      69 days, 10:39:00
SN01331  OTA-REA-29            OTA-CAP-29     69 days, 10:39:00
SN99162  ALB-DS-904            ALB-CAP-4A     69 days, 10:39:00
SS12030  HWB-TF-2              HWB-TF-2       68 days, 19:31:00
SS11197  ADD-TF-7              ADD-TF-7       66 days, 11:30:00
SN09025  PEN-TF-8              PEN-TF-8       64 days, 23:24:00
SS10139  ISL-SCM-5             ISL-SCM-5       64 days, 0:37:00
SN08327  ALB-TF-4              ALB-TF-4        63 days, 1:45:00
SN04176  OTA-CB-922            OTA-CAP-2A     61 days, 17:02:00
SN10801  LTN-TF-2              LTN-TF-2        61 days, 5:58:00
SS04019  STK-SCM-1             STK-SCM-1      56 days, 10:30:00
SN11108  WRK-TF-30             WRK-TF-30       54 days, 1:23:00
SN08058  HEN-CB-312            HEN-HEP4       50 days, 19:46:00
SS03116  BRY HEI               BRY-CAP-4A     47 days, 14:21:00
SS11046  BDE-CB-17             BDE-CAP-1       46 days, 7:01:00
SN01190  HWA-SFD1 Sys_Conditi  HWA-TF-1        42 days, 0:13:00
SS07128  ISL-TF-3              ISL-SVC-3      33 days, 15:40:00
                               ISL-TF-3       33 days, 15:40:00
SS99144  ISL-SCM-5             ISL-SCM-5      32 days, 23:54:00
SS10174  KIK-SVC-2A            KIK-SVC-2A      30 days, 3:01:00
SS11012  BLN-CAP-4             BLN-CAP-4      26 days, 17:15:00
SN07185  OTA-CB-972            OTA-CAP-4A     26 days, 11:19:00
SS02205  ISL Cable_Conn        ISL-SCM-4      25 days, 19:23:00
SN12044  WTU-CB-1102           WTU-TF-4       24 days, 12:05:00
                               RDF-WTU1       24 days, 11:17:00
SN01403  KOE HEI               KOE-CAP-3       24 days, 4:55:00
SN08159  KWA-TF-2              KWA-WIL2       23 days, 23:26:00
SN09133  TNG HEI               TNG-TF-LS1     23 days, 21:02:00
SN05800  ALB Cable_Conn        ALB-CAP-C4B    22 days, 23:53:00
SN07825  MDN-TF-2              MDN-TF-2        18 days, 6:36:00
SS10094  KIK C&I               KIK-SVC-2B      18 days, 0:59:00
SN09078  WWD Prot              MHT-WWD2        17 days, 6:36:00
SS04148  TWZ Prot              TWZ-TF-18      16 days, 10:10:00
SS11038  BRY-CB-39             BRY-TF-4        16 days, 6:37:00
SN11362  OTA-CB-1422           OTA-CAP-30     15 days, 22:29:00
SN04244  BRK-BPE2              BRK-BPE2        14 days, 9:09:00
SS11079  ISL-SVC-9             ISL-SVC-9       14 days, 7:57:00
SS10145  ISL Stn_Serv          ISL-SVC-9       14 days, 4:07:00
SN04080  OTA-CB-492            OTA-TF-12       13 days, 0:41:00
SS11151  GOR-TF-3              GOR-TF-3       11 days, 23:10:00
SS12105  ASB-VT-1              ASB-TF-1       11 days, 21:27:00
SN02805  OTA-CAP-4A            OTA-CAP-4A     11 days, 19:24:00
SS04081  STK-CB-1242           STK-CAP-7D     11 days, 11:52:00
SN07194  TNG Prot              TNG-TF-11       11 days, 3:55:00
SN06128  HEN-TF-ET3            HEN-TF-3       10 days, 23:21:00
                               HEN-TF-ET3     10 days, 23:21:00
SS04059  STK-CB-1242           STK-CAP-7D     10 days, 22:07:00
SN00225  HEP-DS-184            HEN-HEP4       10 days, 17:55:00
SS00176  BDE-CAP-1             BDE-CAP-1      10 days, 17:10:00
SN08113  OTA-CAP-4B            OTA-CAP-4B      10 days, 5:53:00
SN09289  HAY HVDC              HAY-TF-2        10 days, 0:34:00
SS12022  HWB-TF-4              HWB-TF-4        9 days, 23:52:00
SN05090  EDG-OWH1              EDG-OWH1         9 days, 4:30:00
SN11144  WKO-CB-292            WKO-TF-2         9 days, 3:40:00
SS11029  BRY-TF-2              BRY-TF-2         9 days, 2:23:00
SN04278  MTM-CB-312            MTM-CAP-1       8 days, 21:19:00
SN07005  SVL-TF-1              SVL-TF-1        8 days, 20:37:00
                               ALB-SVL1        8 days, 20:25:00
SS06192  IGH-RFN2              IGH-RFN2         8 days, 5:08:00
SN11185  OKI-CB-302            NAP-OKI2         8 days, 1:37:00
SN03339  CPK-TF-3              CPK-TF-3         8 days, 1:28:00
SN05132  BPE-HAY2              BPE-HAY2        7 days, 23:03:00
SN08399  RDF-TF-LS1            RDF-TF-LS1      7 days, 22:46:00
SS11055  BLN-CAP-4             BLN-CAP-4       7 days, 21:45:00
SN04209  TMU-TF-2              TMU-TF-2        7 days, 18:41:00
SN02217  OTA-CAP-4A            OTA-CAP-4A      7 days, 16:37:00
SS07062  ASB-VT-3              ASB-TF-3        7 days, 15:43:00
SN01190  HWA-SFD1 Sys_Conditi  HWA-TF-1        7 days, 15:38:00
SN10141  TMN Cust_Fault        TMN-TF-5        7 days, 13:36:00
SN04244  BRK-BPE1              BRK-BPE1        7 days, 12:53:00
SN07069  ALB-CAP-1             ALB-CAP-1       7 days, 11:08:00
SN02201  PEN-CAP-1             PEN-CAP-1       7 days, 11:06:00
SN01027  OTA-CB-5812           OTA-CAP-29      7 days, 10:07:00
SS01060  ISL-SCM-5             ISL-SCM-5        7 days, 8:07:00
SS03053  KAI Cable_Conn        KAI-TF-2         7 days, 8:03:00
SN06095  ALB-CB-912            ALB-CAP-4B       7 days, 4:07:00
SS01155  AHA-OTI2              AHA-OTI2         7 days, 0:28:00
SN09075  KIN HEI               KIN-TF-4        6 days, 21:19:00
SN07171  OTA-CAP-12            OTA-CAP-12      6 days, 18:19:00
SN10259  FHL-WPW2              KWA-WIL2        6 days, 17:33:00
SN02380  OTA Cable_Conn        OTA-CAP-2A      6 days, 15:15:00
Name: Delta, Length: 100
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#get transformers?
import re
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def str_match(pattern,string):
   match = re.search(pattern, string)
   # If-statement after search() tests if it succeeded
   if match:                      
     return string
   else:
     return nan
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac['TX']=hvac.Flt_Item.map(lambda x: str_match('-TF-',x))
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Int64Index: 9646 entries, 0 to 9645
Data columns:
Ident       9646  non-null values
Flt_Item    9646  non-null values
Date        9646  non-null values
Rem_Item    9646  non-null values
Start       9646  non-null values
End         9646  non-null values
Delta       9646  non-null values
TX          497  non-null values
dtypes: object(8)
\end{verbatim}
\end{codeoutput}
\end{codecell}
Ok, try and get the following:

\begin{enumerate}[1.]
\item
  number of recorded forced outages per year
\item
  forced outage minutes per year?
\item
  most unreliable kit
\end{enumerate}
4.

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#Ok, define some grouping functions and start to try and pull some stats to plot
def by_year(data):
    x = data.groupby(lambda x: x.year)
    return x
def by_month(data):
    x = data.groupby(lambda x: x.month)
    return x
def by_week(data):
    x = data.groupby(lambda x: x.week)
    return x
def by_day(data):
    x = data.groupby(lambda x: x.timetuple().tm_yday) #get day of year
    return x
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#group by event
by_id = hvac.groupby('Ident')

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#group by year
byyear=hvac.groupby(hvac['Start'].map(lambda x: x.year))
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
plt.figure(1)
x={}
#total outages per year
for year,yeardata in byyear:
    print year,len(yeardata.Flt_Item)
    x[year] = len(yeardata.Flt_Item)
total_outages=Series(x)
total_outages[1:].plot(kind='bar',title='Total recored forced outages per year (all types)')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 260
2000 625
2001 735
2002 738
2003 554
2004 662
2005 649
2006 1011
2007 674
2008 786
2009 877
2010 750
2011 847
2012 478
\end{verbatim}
\begin{verbatim}
<matplotlib.axes.AxesSubplot at 0x4737750>
\end{verbatim}
\begin{center}
\includegraphics[width=6in]{forced_outages-svg_files/forced_outages-svg_fig_00.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
total_outages[1:].describe()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
count      13.000000
mean      722.000000
std       140.498517
min       478.000000
25%       649.000000
50%       735.000000
75%       786.000000
max      1011.000000
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
plt.figure(2)
#Transformers per year
x={}
for year,yeardata in byyear:
    print year,len(yeardata.TX[yeardata.TX.notnull()])
    x[year] = int(len(yeardata.TX[yeardata.TX.notnull()]))
x = Series(x)
x[1:].plot(kind='bar',title='Recorded transformer forced outage per year')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 9
2000 53
2001 57
2002 38
2003 20
2004 41
2005 30
2006 41
2007 31
2008 39
2009 40
2010 29
2011 54
2012 15
\end{verbatim}
\begin{verbatim}
<matplotlib.axes.AxesSubplot at 0x4d82350>
\end{verbatim}
\begin{center}
\includegraphics[width=6in]{forced_outages-svg_files/forced_outages-svg_fig_01.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#Forced outage minutes per year (all types)
x={}
for year,yeardata in byyear:
    print year,sum(yeardata.Delta)
    x[year] = sum(yeardata.Delta)
x = Series(x)
#x.plot(kind='bar',title='Total forced outage time per year')   
#x[0:1].day
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 140 days, 4:54:00
2000 120 days, 14:57:00
2001 314 days, 18:10:00
2002 197 days, 14:29:00
2003 272 days, 13:09:00
2004 466 days, 14:21:00
2005 154 days, 21:04:00
2006 225 days, 19:45:00
2007 707 days, 4:02:00
2008 536 days, 5:35:00
2009 343 days, 15:14:00
2010 430 days, 14:59:00
2011 539 days, 17:59:00
2012 293 days, 14:45:00
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
for year,yeardata in byyear:
    print year,yeardata.Flt_Item.count()

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 260
2000 625
2001 735
2002 738
2003 554
2004 662
2005 649
2006 1011
2007 674
2008 786
2009 877
2010 750
2011 847
2012 478
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
for fault_item in unique(hvac.Flt_Item):
    print fault_item

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
LIV-NSY1
CML-FKN2
CML-FKN1
OPK-KPI-SFD2
CYD-CML-TWZ2
CYD-CML-TWZ1
MTI-WKM2
ADD-TF-6
WES HEI
OAM-WTK1
CBE-TF-1
MTI HEI
ISL-SVC-1
TKR-WIL2
KAW Cust_Fault
HBK-HOR1
COB-UTK1
OPK-SFD1
DVK-WPW1
EDG-WAI1
KIN-LFD-TRK2
ANA-DS-1041
GIS-TOB1
ALB-DS-904
ISL-TF-2
OTA-WKM1
ARI-MER1
HEN-MPE2
HEN-MPE1
ROT-CB-15
STU-TIM1
BOB-WES-HAM1
HWB-ROX1
BLN-STK1
RPO-WRK1
WPW-DVK-WDV2
EDN-INV1
TNG HEI
OPK-TF-4
HAM 220kV Bus
BPE-MHO1
OTA-WKM2
NMA Unknown
HAM-TF-5
ARI-KIN2
GIS-TF-1
DVK HEI
MAN-NMA2
MAN-NMA1
NMA-CAP-3
TKU Gen_Fault
KAW-OHK1
MOT-DS-64
BAL-GOR1
TIM HEI
TMN Cust_Fault
EDG-KAW2
HEP-CB-252
WPW-DVK-WDV1
ONG HEI
BRY-CB-62
NMA-CAP-1
FHL-TUI1
TIM-DS-113
HWB-PAL2
ROT-VT-25
PEN-CB-2072
KAW-CT-102
PEN-VT-1792
HWA 110kV Bus
MST Cust_Fault
ISL-SCM-5
NMA Gen_Fault
KWA-WIL1
KPU-WKO2
TKA-TIM1
OKI-TF-31
TIM-DS-43
NSY-ROX1
SFD HEI
TKH-WAI1
KOE-KTA2
KTA Stn_Serv
NMA-TMH2
UHT-DS-87
WTU-DS-854
BPE-TNG1
TNG Cust_Fault
SWN HEI
KAW-CB-582
WIL HEI
MPE Prot
NPK Prot
FHL C&I
TUI Gen_Fault
BPE Cust_Fault
OKN-NPK-ONG1
ARI-PAK1
MLG HEI
ATI-DS-116
TWI HEI
HLY-TMN1
MRR-TF-1
ATI-MTS1
NMA C&I
PEN-CAP-1
EDG-OKE1 HEI
NMA Cust_Fault
HEN Prot
RDF-WRK1
RDF-WHI1
IGH-MCH-KIK1
HLY-SFD1
ALB-HEN2
STK-DS-276
GIS-TUI2
GIS-TUI1
BAL-HWB1
ALB Sys_Conditions
NMA-TMH1
MTS-TF-11
BEN-CB-582
MTM Cust_Fault
ONG-DS-84
TKR Prot
INV-ROX2
KPO-TMU1
MNG HEI
NMA HEI
BRY HEI
ISL-LIV1
OAM-STU-WTK2
BPE-WDV2
BOB-WIR-OTA1
OTA Prot
WRK-WHI1
CST-DS-146
TKU-WKM2
ARI-HTI1
CPK-TF-1
NPL-CB-262
NMA-TMH1 HEI
SFD-TF-10
WTK Comms
COL-HOR2
DOB-IGH1
COL HEI
GYM-KUM1
HWA Surge_Arr
DOB-TF-2
BPE-MTR-OKN1
ARI Comms
GOR-ROX1
ROX-TMH1
INV Prot
OTA-CAP-12
TKR-DS-347
TKR-DS-327
STK-MOT-UTK1
OTI Prot
WAI-TF-3
ASY-WPR1
COL Cust_Fault
WHI Cable_Conn
BRY-REA-1
PAK HEI
FHL-WPW1
BEN-TWZ1 HEI
MTM-TGA-TMI1
KIN-CB-32
MTR-DS-56
EDG 110kV Bus
EDG Prot
TGA Prot
INV-MAN2 HEI
NMA Prot
HWB-PAL1
PRM-CVT-102R
UHT-DS-66
HLY-SFD1 HEI
TKU-TF-21
TKU Stn_Serv
OTA-CB-82
OTA-CAP-11
HAM HEI
FHL-WPW2
ISL-KIK1
BRK HEI
ARI-HTI-ONG1
OHA-TWZ2 Prot
OHA-TWZ1 Prot
GYM-CAP-2
WRA HEI
MLG-TF-2
BRK Prot
KWA-DS-56
KAI-SBK2
TUI-TF-10
SPN-TF-LS1
WRK HEI
TMK-TIM1
HWB-ROX2
OKE-TMI1 HEI
ALB-CB-202
ISL Prot
OHA HEI
WTN HEI
NPL Prot
PEN HEI
ASB-TIM-TWZ1
ISL-TKB1
WHI HEI
HEN HEI
CYD-CML-TWZ1 Prot
AHA-OTI2
ISL-SBK2
BPE-HAY1
MST-GYT-UHT2
MST-GYT-UHT1
TKU-WKM1
TRK-TGA1
WHI Cust_Fault
KOE-KTA1
CUL-KKA1
ROX Scada
ARI-HAM1
KUM-OTI1
MGM-MST1
TKA Prot
RPO-CB-532
OTA HEI
WEL Prot
BLN-ARG-KIK1
HWA-VT-1
TUI HEI
KIK-STK3
PRM-PNI-TKR1
SWN Prot
HEN-HEP3
TMU-TF-2
ISL-SBK1
CST-TF-1
APS Cust_Fault
COL-OTI2
COL-OTI1
WAI-TF-4
MST 110kV Bus
HAY-DS-1004
IGH-WMG-WPT1
TUI-WRA2
WHU Prot
COL-HOR2 HEI
WAI-DS-66
GFD-HAY1
BPE-LTN-WIL1
BPE-LTN-HAY3
SFD Prot
OKI-WRK3
WRK Stn_Serv
PEN Prot
MAN 220kV Bus
UHT-TF-1
OTA C&I
HAM Prot
EDG-TRK2
EDG-TRK1
ROX HEI
EDG-OWH1
WGN-TF-1
MHO-DS-294
PNI 33kV Bus
BPE Prot
KIN-LFD-TRK1
ONG-TF-1
HEN C&I
HWB-PAL2 HEI
ISL-CB-352
BPE HEI
ARI-ANA1
TMK-TIM2
HEN-CAP-1
EDG-OKE1
RDF-TUI1
RDF-TUI2
TUI-WRA1
KHU-DS-274
BRK-SFD2
BRK-SFD1
WMG Prot
IGH-KIK2
PAP-TF-2
TIM-TF-4
HEN-HEP2 HEI
MGM-TF-3
MGM-TF-2
MGM Prot
LTN-TF-2
BPE-MTN-WGN2
OAM Prot
ADD-ISL4
MAN HEI
PRM-DS-204
INV-DS-725
PAK Unknown
WRK-DS-105
KAW-CB-632
DAR-TF-1
WGN Scada
BDE-EDN1
MST-DS-57
OHC Gen_Fault
NPL-TF-7
BDE-CAP-1
HAY C&I
OTA-CAP-4B
PRM-PNI-TKR2
WKM HEI
OTA Unknown
KIN Prot
COB HEI
DAR-MPE1
MPE-CB-132
ROX-TMH2
HEP-CB-182
COL-TF-6
INV-DS-616
HEP-DS-184
DAR HEI
BLN Prot
ALB-CAP-1
STU Prot
OWH-TRK1
BPE-TKU2
OKE-TRK1
OKE-TMI1
SFD-TMN1
TMN Prot
WRK Prot
RPO-TNG1
ISL-SVC-3
ISL-CAP-14
BEN-TF-2
TMN-TF-8
SFD-DS-167
ROX Prot
CPK-TF-2
HLY Prot
WTU Cust_Fault
PEN C&I
HTI C&I
TKR-CB-92
ASY-ISL1
ISL-TIM-TWZ1
AVI Prot
ALB-HEN1
CYD-ROX2
ATI-TRK1
ATI-CB-102
ARI-TF-9
BPE-TKU1
HEN-LT-456
MAN-NMA3
INV-MAN2
OTI HEI
WIL-TF-8
PEN-CB-732
OTI-TF-6
MHO-PRM1 Unknown
ALB HEI
HOR-TF-5
BOB-TF-2
ROT Prot
NMA 220kV Bus
OTA-CB-5812
ONG-CB-82
CML HEI
TRK-TF-1
KAW-CB-52
OTA-PEN5
SFD-TF-6
ARG-KIK1
TAK HEI
MCH HEI
SBK Cust_Fault
HAM-CBG-KPO2
BAL-BWK1
CUL Prot
ONG-CB-162
OWH-TF-2
WKM Prot
ROT-CB-322
NPL-DS-257
MTO-CB-1292
AVI Gen_Fault
HAM Cust_Fault
WRK Cust_Fault
WRK-CB-1082
IGH-KIK2 HEI
WTK Prot
ATI Gen_Fault
ATI HEI
BLN-DS-2139
ISL-KIK3
ABY-TF-2
GIS Prot
ARI-HAM2
KOE Prot
KOE-CB-1192
KOE C&I
CPK-VT-16
SDN HEI
LIV HEI
WHI-CB-8
MGM Cust_Fault
STK-SCM-1
ATI-OHK1
WRA Prot
KAW-TF-2A
WPW HEI
WPW-TF-2
MNI HEI
ISL-CAP-25
KEN Prot
OHK Gen_Fault
WKO-CB-512
ASB Cust_Fault
HEP-DS-244
MLG Prot
KTA-TF-5
KTA-TF-4
KTA-CB-242
RDF-TF-1
TRK Prot
MTM Prot
IGH-WMG-WPT2
BPE-MHO2
ISL-PAP2 Prot
KAW Prot
HEN Sys_Conditions
TMU Unknown
ARI-KIN1
HEN-TF-5
ROS C&I
BOB-WES-HAM2
KIK-DS-126
ARI-MTS1
PRM-TF-3
KAW Unknown
MHO-PRM1
ISL C&I
HLY-TAK-OTA2
TKB HEI
CYD-ROX1
AHA HEI
ISL-DS-333
BPE-MTR1 HEI
STK-DS-234
KTA-VT-12
ISL-CB-332
HEP-DS-196
FHL-TUI1 HEI
MHO Prot
ISL-CAP-22
CPK-VT-10
MAN-NMA2 HEI
PRM-LT-102R
OPK-CVT-3
WIL Sys_Conditions
HWA-SFD1 Sys_Conditi
WPT-CB-39
ROS-DS-54
MGM Sys_Conditions
CPK-WIL1
WIL-CB-202
KWA HEI
TMH-DS-576
HWA-VT-2
HEN-DS-244
KOE HEI
NPK-TF-ET1
OKN-NPK-ONG1 HEI
OPK-TF-5
AHA-CB-122
MNG-DS-224
ROT-DS-367
MHO-DS-44
TRK-DS-227
WRK-DS-126
ATI-DS-84
ATI-CB-82
BOB-DS-84
NPL-SFD2
NPL-SFD1
WHU-WKO2
WHU-WKO1
TKR-DS-184
ROT-CB-362
HOR Prot
HAM-WHU1
PEN-DS-804
PEN-DS-784
MNG-DS-227
BPE-WDV1
UHT Prot
DVK Prot
HIN-KPO1
INV-ROX1 HEI
MHO-PRM2
ANA-CB-1072
HOR-TF-8
ABY-TKA1
AHA-CB-82
KKA Prot
UHT-DS-84
ISL Unknown
KEN-MPE1
EDG-TMI-TRK1
STK Prot
OTA-REA-29
DVK-TF-2
AHA Prot
WTU-TF-3
EDG-KAW3
MPE Unknown
BOB-MER2
EDG-WAI21
ISL-SCM-4
HWB-TF-4
HUI HEI
ALB-VT-11
WRA-TF-1
OTI 11kV Bus
BRY Prot
ROS 110kV Bus
MGM-WDV1
BOB HEI
PAL-DS-94
ARI-MER1 HEI
ATI-CB-112
WPR Prot
GLN-HLY1
WES 110kV Bus
ROS HEI
ROS-CB-62
MAT Prot
ARI-DS-284
MAN-NMA1 HEI
RDF-CB-82
BRY-REA-5
ATI-CB-132
AHA-KUM1
CPK-WIL3
WGN-WVY1
WGN-CB-42
DOB-GYM1
LIV Prot
IGH Prot
ASB-BRY1
SBK-WPR1
WPW Prot
COB-MOT-STK2
MTR-TF-2
BPE-MTR1
BPE-HAY2
HAM-HLY1
HEP-DS-237
GIS-CAP-1
BEN-DS-521
GYM Prot
BAL HEI
BPE-TF-2
INV HEI
STK Scada
ALB Cust_Fault
MNI-SFD1
CST-SFD2
NSY-CB-242
ISL-CAP-C22
SPN-CB-1172
MTI-WKM1
MNG-DS-286
DOB Prot
TNG-TF-11
HAY HVDC
SFD-CB-1112
WKM Unknown
NSY-ROX1 HEI
STK-CB-6
EDG-WAI1 HEI
AVI-CB-112
BPE-MTN-WGN1
BRK-BPE2
HWA-SFD1
HAY HEI
OHK-DS-96
OTA-DS-233
ADD HEI
ISL HEI
TRK-DS-586
WRK-DS-196
WRK-CB-192
ISL Scada
WPR HEI
RPO HEI
NPL-TF-8
ASB HEI
HWB 33kV Bus
KAW-DS-124
CST-MNI1
OWH-VT-5
HAM-WHU2
ARA Prot
RDF-TF-2
MDN-CB-452
NCC HEI
TMU Prot
ASB-VT-8
ABY Prot
COL-HOR3
ARI-BOB1
GLN-DS-1483
FKN-TF-2
CML Prot
OTA-CAP-4A
WRK-PPI-WKM1
ROT-DS-357
TMU-TF-1
MOT-DS-77
HKK Scada
MTM-TF-1
TNG-DS-316
OKN-DS-96
KPU HEI
EDG-CB-142
PRM-DS-84
DAR-MPE2
COL-CB-272
TNG-TF-3
KAI HEI
ROT HEI
PAP-TF-3
HWB-PAL1 HEI
WPR-CB-142
ADD-ISL4 HEI
TGA HEI
KAW-TF-1
MNG-ROS2
OHK HEI
HKK-OTI2
KPO-TMU1 HEI
TKR-DS-304
MHO Cust_Fault
HOR-ISL2
HKK-KUM1
ADD-CB-52
MGM-DS-174
ADD-CB-592
KIK-STK1
TWZ Prot
WTK C&I
GYT Cust_Fault
KOE-MPE2
KOE-MPE1
TMH Prot
BPE-TF-1
OAM Scada
EDG HEI
WPI Gen_Fault
BPE Comms
EDG-DS-326
HEN-CAP-5B
ISL Cable_Conn
MGM HEI
HAY Cable_Conn
GLN HEI
CBG HEI
OHA-CT-702
KWA Prot
OTA-CT-92
BOB-MER5
OTA-TF-2
OTA Cable_Conn
NSY-TF-1
MTI Prot
HLY-TMN1 HEI
EDG-CVT-1
BRB HEI
TWZ-CVT-2
OTA-CB-272
BLN-VT-2067
MTI-CB-112
CST-TF-4
TRK-CB-122
CML 33kV Bus
MTO HEI
HWB-CB-282
MTO Cust_Fault
WRK C&I
MNG 110kV Bus
CUL-WPR1
OTA Comms
MPE Stn_Serv
EDG-CB-252
OKI HEI
DVK Stn_Serv
EDN Cust_Fault
HEN-CB-3222
TMH-CVT-11
MOT Prot
HWB-DS-205
ISL-CB-542
OTA-CB-302
SBK-TF-2
STK-TF-9
MNG-CB-2338
HWB-TF-5
MLG C&I
KAI Cable_Conn
BLN-DS-74
HEN-CB-912
BDE-GOR1
TRK-CB-342
WRK Comms
HWA HEI
ISL-DS-566
OHA-TWZ2
OHA-TWZ1
OTA-CB-922
WPW Cust_Fault
HEN-HEP1
OAM HEI
ARI-CB-152
WHI-DS-587
TIM Comms
WRK Unknown
OTI Scada
BRK-DS-1107
TMI-OWH-TRK1
WPA HEI
HAY Prot
ALB Prot
MST Prot
OWH-TF-1
HOR-CB-1272
MNI Comms
PNI-CB-222
KAW Cable_Conn
WKM 220kV Bus
PAK C&I
OKI-DS-235
KIK-STK3 HEI
WTU-DS-1033
TMK Prot
ALB-CB-912
BEN HVDC
BOB-CB-292
OTA-CB-262
WIR Prot
MTM-DS-67
HEN-CB-412
MPE-CB-252
FHL Prot
WIL-CB-392
KAW-DS-597
BLN HEI
HEP-ROS1
KPU-WKO1
OKN-CB-92
HWA-WVY1
ISL-CB-1492
AVI HEI
SFD-CB-162
APS-DS-126
CLH-OTI1
HUI-MNI1
KAW-DS-174
DOB HEI
COL Prot
MHO HEI
KAW-DS-64
BPE-DS-533
BPE-DS-555
HTI HEI
ROT-TF-4
NPK-CB-232
PAP Prot
NPL HEI
CPK-VT-2
MTM HEI
OTC-DS-884
HOR-CB-72
DVK-CB-37
PAP HEI
CPK-TF-4
TMN-TF-5
CPK-DS-74
CPK-TF-3
KPO Comms
HEP-CB-202
HEP HEI
HOR-CT-142
ISL 66kV Bus
WVY Prot
HAM-CT-442
HWA Gen_Fault
FHL-DS-159
NPL-CB-222
HEN Unknown
STK HEI
GIS-DS-234
BRY-ISL1
HWA-TF-2
SFD 110kV Bus
HOR-ISL1
MRA Cust_Fault
ROS-CB-172
UHT Cable_Conn
TKR-WIL1
WDV-CB-9
OTA-CB-492
OHB-CB-802
MNG Prot
CUL-CB-142
DVK-WPW-FHL2
MAN-DS-276
MDN-TF-1
MHO-TF-3
WVY Unknown
WKO Prot
MDN-CVT-45
GOR-CB-282
KAW-CB-622
TMH-DS-605
WEL-TF-1
BRK-CVT-12
HAM-CBG-KPO1
WEL Cust_Fault
KKA Unknown
APS HEI
HKK Comms
OTI Comms
WRK-DS-194
MDN-MPE1
MDN HEI
EDG-WAI2
KAW HEI
MTN-CB-42
KPO HEI
STK-CB-1242
CYD HEI
WGN Prot
HAY-CB-552
HUI-CB-862
SVL Prot
ASB Scada
ASB-CB-1102
SFD-LT-534
MRA Stn_Serv
PAL-CB-212
MTN HEI
SBK HEI
KWA Cust_Fault
KOE-CB-162
ABY Unknown
WPR-CB-102
EDG-TF-8
TRK-DS-147
HLY-CB-402
TRK-DS-197
BLN-KIK1
SFD-CVT-31
SFD Gen_Fault
IGH-WPT1
OHC Scada
WPT-TF-1
OTA-REA-4A
NMA-TF-2
WDV HEI
BRY-CAP-5A
BRK-BPE1
HWA Sys_Conditions
KPI Gen_Fault
MTM-CB-312
OPK-LT-525
MST-UHT2
MST-UHT1
SVL HEI
OTA-WKM3
ADD-DS-124
HTI Prot
MNI Cust_Fault
WPW-DVK-WDV2 HEI
KIN-TF-2
TMU-DS-54
TMU-DS-44
ROS Prot
KIN C&I
ISL-KIK3 HEI
SBK-WPR1 HEI
ASY-WPR1 HEI
OAM-WTK2
MTM-CAP-1
TWZ-CB-2672
WHU Sys_Conditions
COB Prot
LIV-WTK1
GYM-CB-5
WIL-TF-3
ASY Prot
BOB-HAM1
HAY-CB-192
TKH-WAI1 HEI
HTI-DS-114
IGH Comms
PAL Prot
INV-TWI1
ARI-HTI1 HEI
BDE HEI
WTK Scada
KEN-TF-1
HOR-DS-76
SPN Prot
ALB Cable_Conn
DAR-TF-2
MOT-TF-6
HKK-KUM1 HEI
COB Comms
OTA-DS-245
ROT-DS-354
WHI C&I
OKN HEI
HAY-DS-245
OPK-SFD2
MPE-TF-1
PEN-TF-10
NPK Scada
ARI Prot
WRK Gen_Fault
ADD-ISL2
OTA-WKM2 HEI
RPO Comms
ADD-ISL3
HEN Scada
MTM-TRK1
SFD Comms
CPK Prot
WIR-DS-666
STK C&I
MST-CB-312
TWZ Cust_Fault
GFD-HAY2
TMK-CVT-132
ISL-SPN2
ISL-SPN1
CUL HEI
ISL-CB-982
HUI-CB-822
KIN-TF-1A
OHK-CB-102
WKO-TF-2
WHU-TF-1
ADD-VT-28
EDG-TF-5
BLN-CAP-4
BWK Gen_Fault
ROS-TF-4
RPO Prot
HAY-TKR2
HAY-TKR1
SFD Cable_Conn
TMN HEI
FKN Comms
WRK Cable_Conn
CPK Sys_Conditions
NPK-DS-76
PAK-DS-1654
HAM-TF-2
BRB-VT-22
BDE-DS-127
DAR-DS-57
WHI-DS-527
WPW-CB-222
BDE-DS-107
BDE Unknown
MPE-DS-1394
BEN Gen_Fault
LTN-TF-3
OTA Stn_Serv
OTA-CB-252
HOR 66kV Bus
HLY-TWH1
WVY-TF-2
KAI-SBK1
DOB-IGH1 HEI
MST HEI
MST Scada
HTI-TF-2
PEN-VT-13
EDG-KAW1
HAY-UHT2
BRY-CAP-6A
TWH-DS-416
TWZ 33kV Bus
HEP Prot
CPK HEI
WAI C&I
BEN Prot
ASB Prot
TMN-TWH1
TWH Scada
OWH-TMI-TRK1
WPT-VT-1
STK Cable_Conn
PEN-TF-8
BRY-DS-407
SBK-DS-107
OHB-CB-1102
HWA-DS-87
CST-CB-7
CST-VT-38
OTA-DS-565
UHT HEI
NMA-TF-ET1
CPK-TF-5
PAP-REA-3
CST-NPL2 HEI
GYM HEI
HAY-WIL1 HEI
MTN-DS-1087
OTA-DS-506
NPK Cust_Fault
OKI C&I
KIN-TRK1
TWZ HEI
COL-OTI2 HEI
CLH-COL1 HEI
EDN-TF-1
HEN-CB-282
ADD-CB-122
ADD Prot
TKR-WIL1 HEI
BRY-CT-82
ADD-CB-28
HEP-TF-1
STK 33kV Bus
STK Stn_Serv
STK-CB-432
OAM-BPT-WTK1
IGH-KIK1
KIK Prot
DOB-RFN-IGH1
MDN Prot
TKR-CB-112
DVK-WDV1
IGH-ROB-WPT1
FKN 33kV Bus
ISL-DS-355
SPN HEI
HEN-TF-ET3
CST-TF-2
OAM-STU-WTK2 HEI
PEN-TF-9
WPT-TF-2
ALB-HPI1
ALB-HEN3
IGH-RFN2
PRM Cust_Fault
OTA-ROS1
MPE HEI
STU HEI
PAP-TF-1
KIK-DS-366
WGN Stn_Serv
KUM Prot
DOB Sys_Conditions
OAM-VT-3
WDV-TF-1
BRK-CVT-2
OKI Prot
ABY C&I
BEN-OHB1
CYD-TF-8
FHL-CB-312
PAK-PEN1
DVK-TF-1
NPL-CB-72
CLH C&I
MDN Gen_Fault
OKN-CB-72
LTN-CB-152
BOB-DS-44
STU-CB-72
MDN C&I
HEP-TF-2
SFD Sys_Conditions
BRK Sys_Conditions
GLN-DS-1455
ISL-KIK2
WKO-CB-552
GLN-DS-1664
HAM-REA-2
WRK-DS-146
BEN-DS-493
BPE-CT-532
TRK-DS-237
TMK-CB-1232
CST Cust_Fault
KOE Sys_Conditions
OTA-CB-10
KIK-DS-106
TKH-CB-1
MTM-CB-92
OAM Cust_Fault
WPT Unknown
BPE-MHO2 HEI
ROS-TF-3
ADD-TF-5
COB-UTK1 Comms
WDV Reg
IGH-ROB-WPT2
MPI-UTK1
CST-NPL2
CST-NPL1
OWH Prot
HWB HEI
TIM-TF-5
ISL-TF-1
TKH Prot
MTM-TF-3
RDF Cust_Fault
SVL-TF-1
OTA-DS-974
HEN-SWN1
GLN-TAK-OTA1
INV-ROX1
KIN-TRK2
WGN-DS-96
IGH-KIK-MCH1
BLN-STK2
MTM Unknown
CLH-COL1
MST-CB-72
COL-HOR3 HEI
HOR-DS-106
NPL-VT-39
HIN-CB-232
HEN-OTA1
ISL-CB-4112
PEN-DS-744
PEN-DS-756
WPR C&I
KPU-TF-4
WPT Surge_Arr
HLY-OTA1
OTA-DS-585
OTA-DS-583
TMU HEI
OTA-CB-39
ASY-TF-3
TMK-CB-112
ONG Cust_Fault
WVY-DS-94
TKA HEI
WDV-CB-11
ASB-VT-3
COB Scada
OTA-DS-563
WTU Comms
APS-OTI1
ATU-RFN-IGH1
WIL-DS-133
BDE-CB-17
BDE-CB-21
ASY-SBK1
HAM-KPO1
TIM-TF-8
WTU C&I
HEN-HEP4
OKN Prot
OTA Cust_Fault
BOB-CB-142
MDN 110kV Bus
MDN-VT-52
MDN-TF-2
TRK 11kV Bus
BRK-SFD3
WRK-DS-144
MDN 220kV Bus
TIM-TF-3
WGN-CB-2052
MPE-TF-4
KIK-DS-84
KIK-DS-104
OTA-CB-972
OTA-CB-562
ISL-CB-1422
OTA-CB-422
OWH-DS-104
OWH-CB-92
ONG-DS-174
TMI Cust_Fault
ABY-TIM1
ISL-CB-152
TNG Prot
RDF-TUI2 HEI
ISL-TF-3
ALB-CB-902
TWH-DS-456
EDG-OWH2
BPE-TF-15
KIN-CB-2242
RDF Prot
ATI-TRK2
ONG Prot
ISL Stn_Serv
HEN-WEL-MTO-MPE1
CLH-DS-644
COL-CLH-APS-OTI1
WPT Reg
ARI-DS-156
ARI-DS-146
KIK Unknown
KAW-CT-FDRA
OHA Prot
BOB-TF-3
COL-HOR2 Sys_Conditi
TWH Prot
HWA Prot
SPN 33kV Bus
ADD-CB-102
TUI-TF-15
WHU-TF-3
HKK Cust_Fault
HEN-WEL-MTO-MPE2
FHL Scada
BRB-VT-13
FKN-TF-4
TMI Unknown
NMA-TF-1
LTN Prot
ATU Prot
GYT-TF-3
MTI 220kV Bus
OTA-CB-162
TMU-DS-84
BRK-SFD1 HEI
HAY-CB-82
HEN-REA-5A
GLN-DS-605
BRY-CB-92
GYT HEI
TUI-DS-134
DAR Prot
OKI-DS-275
TKR HEI
KMO-TMI1
HEN-CB-312
STU-TIM1 HEI
BRY Scada
BRY-TF-2
BAL-BWK-HWB1
HEN-TF-1
ROS-DS-114
HOR HEI
ALB-DS-727
TKA-ABY-TIM1
PEN Cust_Fault
TKH 11kV Bus
HUI Prot
OTA-PEN6
MLG-DS-54
WHU-CB-92
OKI-CB-1012
KAW-CB-172
TWZ-CB-2412
KWA-TF-2
BAL C&I
ROS-CB-112
BAL-TF-1
MPE-VT-34
TUI-CB-24
CBG Prot
ALB-SVC-7
GOR Surge_Arr
STK-CB-2182
BOB-WIR-OTA2
WRA-TF-2
ATU-DOB1
EDG-OWH2 HEI
BOB Prot
KAI-TF-2
ALB-CAP-2
OTA-CB-502
HEN-WEL1
TGA-DS-1204
KTA Scada
WRA-CB-37
KIK HEI
HAY-MLG1
WDV-DS-44
GYT Prot
HAY-CB-112
WDV Sys_Conditions
MST Sys_Conditions
BEN HEI
OKI-VT-40
ARI-KIN1 HEI
OTA 220kV Bus
OKI-DS-306
ALB-TF-4
PNI C&I
SDN 220kV Bus
MHO-PRM1 HEI
MPE-CB-242
HLY C&I
TKU-DS-86
CPK-WIL2
HWA-CB-102
ADD Cable_Conn
PAK-DS-636
ONG-DS-214
TMU 110kV Bus
KAW-TF-ET6
GLN-TAK-OTA1 HEI
MDN Cust_Fault
FHL-RDF2 HEI
KIN-LFD-TRK1 HEI
DVK-DS-104
ISL Sys_Conditions
ISL-DS-805
RDF-TF-LS1
TGA-DS-274
ROT Cable_Conn
TKA-CB-37
HAY-CB-272
ASB-TIM-TWZ2
PAL-TF-1
HWB-TF-2
WDV Cable_Conn
HEN-CB-272
COL Scada
SFD-CB-72
OKI-CB-302
OHC-CB-1358
OWH-TMI-TRK1 HEI
HUI-TF-6
MDN-TF-3
BRY-REA-4
MPE-CB-222
WHU HEI
ARI-CB-202
EDG-TF-4
KMO-MTM-TGA2
KMO Prot
FHL-RDF1
OWH Scada
KIN HEI
PAP-REA-2
BRY-TF-3
WWD Prot
CYD MetalClad_Conn
NMA-CVT-8
TMI HEI
GYM-DS-104
TWH Comms
BPE-CT-552
KOE-CB-1202
BPE-DS-895
WWD HEI
CYD Gen_Fault
WWD-CB-242
MNI-TF-3
ISL-TF-7
OTA-CB-2832
MOT Cable_Conn
MOT Sys_Conditions
OTI Sys_Conditions
BAL Cable_Conn
ISL-WPR-CUL-KIK2
SVL-TF-2
CPK-WWD-WIL3
CPK-WWD-WIL2
MHO-CB-302
TWZ-CB-2562
CST Prot
EDG-WAI2 HEI
WRK-DS-103
IGH-CVT-362
ISL-TF-LS1
ISL-CAP-15
OHC Prot
HEN-OTA1 HEI
CYD-CVT-442
MPE-DS-244
MLG-TF-1
CST-CB-62
GFD HEI
BEN-TF-29
CPK C&I
APS-TF-1
KAW-OHK1 HEI
OTA Scada
CPK Cust_Fault
ISL-CAP-16
GOR-CB-72
KTA-CB-1092
WEL HEI
CST HEI
ROS-DS-106
PAK-DS-594
TIM 110kV Bus
WHI-TF-1
HAY-WIL1
PAP-DS-114
OTA-CB-172
MTM-DS-44
MLG-VT-39
STK Sys_Conditions
BDE Prot
EDG-DS-207
HWB-ROX2 HEI
HWB-ROX1 HEI
HAM-OHW1
KAW-DS-176
TKR Stn_Serv
BPE-CT-692
OTA-TF-4
STK Cust_Fault
TAK-CB-1362
HEP-CB-1182
HWB C&I
BDE-CB-18
TIM Cust_Fault
BDE Scada
MGM-MST1 HEI
TWZ C&I
TMI Prot
BRB Cust_Fault
EDN Prot
BEN-TF-27
TWH Sys_Conditions
OWH Cable_Conn
NSY HEI
ISL-DS-479
OTI Cust_Fault
OHW-WKM1
HAM-WKM1
OKI-WRK1
TRK-TF-2
TMU 11kV Bus
OTA-ROS2
OTA 11kV Bus
ISL-WPR-CUL-KIK3
CST-CB-142
OHB Gen_Fault
EDG-KAW2 HEI
STU Sys_Conditions
GYM-KUM1 HEI
KOE-KTA1 HEI
ISL-SVC-9
SDN-DS-477
DOB-CB-132
GYM Cust_Fault
DOB C&I
GOR HEI
PAP-REA-4
WHI Prot
KAW-CB-26
FKN HEI
OPK Cust_Fault
BEN C&I
SDN-DS-1034
OTA-CT-302
BRY Cable_Conn
KIK-SVC-2B
WDV-DS-46
OKI-DS-305
HAY-CB-182
KIK C&I
WTK Stn_Serv
WTU-DS-814
HAM C&I
ROS-DS-1064
MDN Sys_Conditions
GYM C&I
TMH HEI
ATI-WKM1
KTA-CAP-1
MTM-CT-52
BRB-CB-122
TNG-TF-12
HKK Prot
TMN Comms
EDN-DS-46
TWC Gen_Fault
ALB-CB-222
HWA-DS-324
LTN HEI
TGA-CB-39
SPN-DS-1224
OKI-DS-276
SPN-TF-2
SPN-TF-1
ISL-TF-6
ISL-PAP4
ADD-MLN-ISL1
SPN Scada
ADD-DS-256
ISL Surge_Arr
TKH C&I
SDN-TMH1
ATU Comms
TUI-CB-122
GLN-DS-1494
TUI Prot
BEN-VT-1139
KIN Sys_Conditions
HIN-DS-227
KIK Stn_Serv
ONG-DS-64
BOB-HAM2
WHI-TF-2
OTA-DS-576
OHA Gen_Fault
UTK Prot
STK-CB-212
UTK-CB-192
SDN 33kV Bus
ADD-DS-136
ISL-DS-546
DAR-CB-72
KIK-SVC-2A
HPI-MDN1
PRM Cable_Conn
PRM 33kV Bus
OAM-TF-1
OPK C&I
MTO Comms
ROT C&I
BLN-CB-102
TMI 110kV Bus
TMI-CB-102
HTI Cust_Fault
CUL-TF-ET1
MAT HEI
ALB-TF-7
NPK HEI
BRY-TF-6
BRY-TF-5
ADD-TF-7
UTK-CB-202
BRY-DS-804
BRY-CB-39
OTA-DS-423
OTA-TF-ET4
OKI-WRK3 HEI
WIR C&I
OPK-SFD1 HEI
TKH HEI
MAT Stn_Serv
WPW Cable_Conn
ADD Surge_Arr
WRK-TF-30
HOR-ISL1 HEI
OTA-DS-575
TMI Cable_Conn
CBG-CB-242
EDG-DS-424
WKO-CB-292
ABY-CB-62
DRY-HLY1
KTA-CB-Q3
PAP-TF-4
BRY-TF-ET5
WIL Prot
EDG-CB-272
WEL-CB-1042
TNG-DS-225
OTA-TF-11
TAK-TF-5
KIN-CB-352
HAY-UHT1
OWH-VT-4
KMO-TRK2
KMO-TRK1
KPO-CB-92
HAY-LTN1
BPE-TWC-LTN1
HEN-CT-522
HAM 110kV Bus
CST-HUI1
HEN-CB-322
TMI MetalClad_Conn
BPE-CB-632
HAM-TF-4
WPW-CB-52
GOR-TF-3
INV Cable_Conn
ROT-TRK2
HAM-TF-6
GIS Sys_Conditions
HAY-CB-822
ROX-TF-10
MTM-PIE2 HEI
WIL-CB-192
ROS-DS-126
PRM-PNI-TKR2 HEI
PRM-PNI-TKR1 HEI
TWH-TF-1
ONG-DS-154
HTI-DS-107
HLY-TF-ET22
PAK-DS-656
RPO-CB-632
DOB-RFN-IGH2
TKB Sys_Conditions
OTA-CB-1422
HAY-CB-132
MHO-DS-314
FHL HEI
GLN-DS-1674
WVY Cust_Fault
ISL-LIV1 HEI
WTU Prot
ALB-CB-702
TKU HEI
TRK HEI
ISL-VT-2112
GIS HEI
WPT-VT-39
WTU-CB-1102
BWK-CB-82
STU-DS-77
BAL-GOR1 HEI
EDN HEI
HIN Prot
HEN-CB-292
MTM-PIE2
OTA-TF-12
WVY-DS-46
MNI Prot
MOT HEI
WPW-CB-232
KEN-TF-2
WPT-CT-39
WTK Surge_Arr
BDE-CB-122
WAI-TF-2
MNG Comms
WHU-CB-282
CBG-CB-39
ADD-TF-3
ROT-DS-366
KIK Cust_Fault
CLH-TF-1
APS-CLH1
ALB-TF-6
ASB-VT-1
KAW-VT-26
DRY Prot
MTR-OKN1
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
events = hvac.groupby(hvac.Ident)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
rng = date_range(datetime(1999,7,1),datetime(2012,7,1), freq='M')
rng.map(lambda x: x.date())

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
array([1999-07-31, 1999-08-31, 1999-09-30, 1999-10-31, 1999-11-30,
       1999-12-31, 2000-01-31, 2000-02-29, 2000-03-31, 2000-04-30,
       2000-05-31, 2000-06-30, 2000-07-31, 2000-08-31, 2000-09-30,
       2000-10-31, 2000-11-30, 2000-12-31, 2001-01-31, 2001-02-28,
       2001-03-31, 2001-04-30, 2001-05-31, 2001-06-30, 2001-07-31,
       2001-08-31, 2001-09-30, 2001-10-31, 2001-11-30, 2001-12-31,
       2002-01-31, 2002-02-28, 2002-03-31, 2002-04-30, 2002-05-31,
       2002-06-30, 2002-07-31, 2002-08-31, 2002-09-30, 2002-10-31,
       2002-11-30, 2002-12-31, 2003-01-31, 2003-02-28, 2003-03-31,
       2003-04-30, 2003-05-31, 2003-06-30, 2003-07-31, 2003-08-31,
       2003-09-30, 2003-10-31, 2003-11-30, 2003-12-31, 2004-01-31,
       2004-02-29, 2004-03-31, 2004-04-30, 2004-05-31, 2004-06-30,
       2004-07-31, 2004-08-31, 2004-09-30, 2004-10-31, 2004-11-30,
       2004-12-31, 2005-01-31, 2005-02-28, 2005-03-31, 2005-04-30,
       2005-05-31, 2005-06-30, 2005-07-31, 2005-08-31, 2005-09-30,
       2005-10-31, 2005-11-30, 2005-12-31, 2006-01-31, 2006-02-28,
       2006-03-31, 2006-04-30, 2006-05-31, 2006-06-30, 2006-07-31,
       2006-08-31, 2006-09-30, 2006-10-31, 2006-11-30, 2006-12-31,
       2007-01-31, 2007-02-28, 2007-03-31, 2007-04-30, 2007-05-31,
       2007-06-30, 2007-07-31, 2007-08-31, 2007-09-30, 2007-10-31,
       2007-11-30, 2007-12-31, 2008-01-31, 2008-02-29, 2008-03-31,
       2008-04-30, 2008-05-31, 2008-06-30, 2008-07-31, 2008-08-31,
       2008-09-30, 2008-10-31, 2008-11-30, 2008-12-31, 2009-01-31,
       2009-02-28, 2009-03-31, 2009-04-30, 2009-05-31, 2009-06-30,
       2009-07-31, 2009-08-31, 2009-09-30, 2009-10-31, 2009-11-30,
       2009-12-31, 2010-01-31, 2010-02-28, 2010-03-31, 2010-04-30,
       2010-05-31, 2010-06-30, 2010-07-31, 2010-08-31, 2010-09-30,
       2010-10-31, 2010-11-30, 2010-12-31, 2011-01-31, 2011-02-28,
       2011-03-31, 2011-04-30, 2011-05-31, 2011-06-30, 2011-07-31,
       2011-08-31, 2011-09-30, 2011-10-31, 2011-11-30, 2011-12-31,
       2012-01-31, 2012-02-29, 2012-03-31, 2012-04-30, 2012-05-31,
       2012-06-30], dtype=object)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
#Plot an 'outage tree'
#Ok this bit of code attempts to plot the forced outages over time

plt.figure(1,figsize=[200,10])
flipper = -1.0
for event,data in events: #cycle through the events
    flipper =flipper*(-1.0)
    datas = data.sort(columns='Start',ascending=False)
    y = range(datas.Flt_Item.count())
    xs = datas.Start.tolist()
    xe = datas.End.tolist()
    outage_id = datas.Rem_Item.tolist()
    x=0
    for xss in xs:
        #print [xs[x],xe[x]],[y[x],y[x]]
        plt.plot([xs[-1],xs[-1]],[0,flipper*datas.Flt_Item.count()],lw=0.04)
        hold('on')
        plot([xs[x],xe[x]],[(flipper*y[x]+flipper),(flipper*y[x]+flipper)],lw=0.02)
        #plt.annotate(outage_id[x],xy = (xe[x], (flipper*y[x]+flipper)),rotation=flipper*45,fontsize=4)
        if y[x]>0:
            plt.annotate(outage_id[x],xy = (xe[x], (flipper*y[x]+flipper)),fontsize=3)
        x+=1
    #ylim([-20,20])
    xticks(rng,rng.map(lambda x: x.date()))
    grid('on')
    
    
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{center}
\includegraphics[width=6in]{forced_outages-svg_files/forced_outages-svg_fig_02.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
def outage_tree(ydata,year):
   #Plot an 'outage tree'
   #Ok this bit of code attempts to plot the forced outages over time
   print ydata
   events = ydata.groupby(ydata.Ident)
   #plt.figure(figsize=[20,20])
   flipper = -1.0
   for event,data in events: #cycle through the events
      flipper =flipper*(-1.0)
      datas = data.sort(columns='Start',ascending=False)
      y = range(datas.Flt_Item.count())
      xs = datas.Start.tolist()
      xe = datas.End.tolist()
      outage_id = datas.Rem_Item.tolist()
      x=0
      for xss in xs:
         #print [xs[x],xe[x]],[y[x],y[x]]
         plot([xs[-1],xs[-1]],[0,flipper*datas.Flt_Item.count()])
         hold('on')
         plot([xs[x],xe[x]],[(flipper*y[x]+flipper),(flipper*y[x]+flipper)])
         #annotate(outage_id[x],xy = (xe[x], (flipper*y[x]+flipper)),rotation=flipper*45)
         x+=1
   #title(year)
   #xlabel('Date and time')
   #ylabel('Number of removed items')
   xlim([datetime(year,1,1,0,0),datetime(year+1,1,1,0,0)])
   ylim([-10,10])
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac2 = hvac.set_index(['Ident','Flt_Item'])

\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac3 = hvac2.groupby(level=1)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac2

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
MultiIndex: 9168 entries, (u'SS99101', u'LIV-NSY1') to (u'SN11379', u'HEN-WEL-MTO-MPE1')
Data columns:
Date        9168  non-null values
Rem_Item    9168  non-null values
Start       9168  non-null values
End         9168  non-null values
Delta       9168  non-null values
TX          482  non-null values
dtypes: object(6)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
plt.figure(figsize=[20,40])
hvac_year = hvac.groupby(hvac.Start.map(lambda x: x.year))
i=0
for year,yearly_data in hvac_year:
    subplot(12,1,i)
    print year,len(yearly_data.index)
    outage_tree(yearly_data,year)
    i+=1
plt.title('HVAC: Enduring Forced Asset Outage tree')
plt.savefig('test.png', bbox_inches='tight')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 260
<class 'pandas.core.frame.DataFrame'>
Int64Index: 260 entries, 0 to 259
Data columns:
Ident       260  non-null values
Flt_Item    260  non-null values
Date        260  non-null values
Rem_Item    260  non-null values
Start       260  non-null values
End         260  non-null values
Delta       260  non-null values
TX          9  non-null values
dtypes: object(8)
2000
\end{verbatim}
\begin{verbatim}
625
<class 'pandas.core.frame.DataFrame'>
Int64Index: 625 entries, 260 to 884
Data columns:
Ident       625  non-null values
Flt_Item    625  non-null values
Date        625  non-null values
Rem_Item    625  non-null values
Start       625  non-null values
End         625  non-null values
Delta       625  non-null values
TX          53  non-null values
dtypes: object(8)
2001
\end{verbatim}
\begin{verbatim}
735
<class 'pandas.core.frame.DataFrame'>
Int64Index: 735 entries, 885 to 1619
Data columns:
Ident       735  non-null values
Flt_Item    735  non-null values
Date        735  non-null values
Rem_Item    735  non-null values
Start       735  non-null values
End         735  non-null values
Delta       735  non-null values
TX          57  non-null values
dtypes: object(8)
2002
\end{verbatim}
\begin{verbatim}
738
<class 'pandas.core.frame.DataFrame'>
Int64Index: 738 entries, 1620 to 2357
Data columns:
Ident       738  non-null values
Flt_Item    738  non-null values
Date        738  non-null values
Rem_Item    738  non-null values
Start       738  non-null values
End         738  non-null values
Delta       738  non-null values
TX          38  non-null values
dtypes: object(8)
2003
\end{verbatim}
\begin{verbatim}
554
<class 'pandas.core.frame.DataFrame'>
Int64Index: 554 entries, 2358 to 2911
Data columns:
Ident       554  non-null values
Flt_Item    554  non-null values
Date        554  non-null values
Rem_Item    554  non-null values
Start       554  non-null values
End         554  non-null values
Delta       554  non-null values
TX          20  non-null values
dtypes: object(8)
2004
\end{verbatim}
\begin{verbatim}
662
<class 'pandas.core.frame.DataFrame'>
Int64Index: 662 entries, 2912 to 3573
Data columns:
Ident       662  non-null values
Flt_Item    662  non-null values
Date        662  non-null values
Rem_Item    662  non-null values
Start       662  non-null values
End         662  non-null values
Delta       662  non-null values
TX          41  non-null values
dtypes: object(8)
2005
\end{verbatim}
\begin{verbatim}
649
<class 'pandas.core.frame.DataFrame'>
Int64Index: 649 entries, 3574 to 4222
Data columns:
Ident       649  non-null values
Flt_Item    649  non-null values
Date        649  non-null values
Rem_Item    649  non-null values
Start       649  non-null values
End         649  non-null values
Delta       649  non-null values
TX          30  non-null values
dtypes: object(8)
2006
\end{verbatim}
\begin{verbatim}
1011
<class 'pandas.core.frame.DataFrame'>
Int64Index: 1011 entries, 4223 to 5233
Data columns:
Ident       1011  non-null values
Flt_Item    1011  non-null values
Date        1011  non-null values
Rem_Item    1011  non-null values
Start       1011  non-null values
End         1011  non-null values
Delta       1011  non-null values
TX          41  non-null values
dtypes: object(8)
2007
\end{verbatim}
\begin{verbatim}
674
<class 'pandas.core.frame.DataFrame'>
Int64Index: 674 entries, 5234 to 5907
Data columns:
Ident       674  non-null values
Flt_Item    674  non-null values
Date        674  non-null values
Rem_Item    674  non-null values
Start       674  non-null values
End         674  non-null values
Delta       674  non-null values
TX          31  non-null values
dtypes: object(8)
2008
\end{verbatim}
\begin{verbatim}
786
<class 'pandas.core.frame.DataFrame'>
Int64Index: 786 entries, 5908 to 6693
Data columns:
Ident       786  non-null values
Flt_Item    786  non-null values
Date        786  non-null values
Rem_Item    786  non-null values
Start       786  non-null values
End         786  non-null values
Delta       786  non-null values
TX          39  non-null values
dtypes: object(8)
2009
\end{verbatim}
\begin{verbatim}
877
<class 'pandas.core.frame.DataFrame'>
Int64Index: 877 entries, 6694 to 7570
Data columns:
Ident       877  non-null values
Flt_Item    877  non-null values
Date        877  non-null values
Rem_Item    877  non-null values
Start       877  non-null values
End         877  non-null values
Delta       877  non-null values
TX          40  non-null values
dtypes: object(8)
2010
\end{verbatim}
\begin{verbatim}
750
<class 'pandas.core.frame.DataFrame'>
Int64Index: 750 entries, 7571 to 8320
Data columns:
Ident       750  non-null values
Flt_Item    750  non-null values
Date        750  non-null values
Rem_Item    750  non-null values
Start       750  non-null values
End         750  non-null values
Delta       750  non-null values
TX          29  non-null values
dtypes: object(8)
2011
\end{verbatim}
\begin{verbatim}
847
<class 'pandas.core.frame.DataFrame'>
Int64Index: 847 entries, 8321 to 9167
Data columns:
Ident       847  non-null values
Flt_Item    847  non-null values
Date        847  non-null values
Rem_Item    847  non-null values
Start       847  non-null values
End         847  non-null values
Delta       847  non-null values
TX          54  non-null values
dtypes: object(8)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
hvac_year = hvac.groupby(hvac.Start.map(lambda x: x.year))
total_events={}
size_events = {}
for year,yearly_data in hvac_year:
    x={}
    xs={}
    ident_data = yearly_data.groupby(yearly_data.Ident)
    for ident,ident_data in ident_data:
       x[ident_data.Start.tolist()[0]]=ident_data.Start.tolist()[0]
       xs[ident_data.Start.tolist()[0]]=len(ident_data.Start.tolist())
    x=Series(x)
    xs=Series(xs)
    print 'No events = ' + str(len(x.diff().tolist()[1:])-1) + ':  Mean time between events for ' + str(year) + ' : ' + str(sum(x.diff().tolist()[1:])/(len(x.diff().tolist()[1:])-1))
    total_events[year]=len(x.tolist())
total_events = Series(total_events)        
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
No events = 176:  Mean time between events for 1999 : 1 day, 0:14:23.181818
No events = 419:  Mean time between events for 2000 : 20:55:41.384248
\end{verbatim}
\begin{verbatim}
No events = 519:  Mean time between events for 2001 : 16:44:00
\end{verbatim}
\begin{verbatim}
No events = 486:  Mean time between events for 2002 : 17:56:34.814814
\end{verbatim}
\begin{verbatim}
No events = 379:  Mean time between events for 2003 : 22:56:45.277044
\end{verbatim}
\begin{verbatim}
No events = 423:  Mean time between events for 2004 : 20:44:42.836879
\end{verbatim}
\begin{verbatim}
No events = 439:  Mean time between events for 2005 : 19:48:06.697038
\end{verbatim}
\begin{verbatim}
No events = 584:  Mean time between events for 2006 : 14:55:15.205479
\end{verbatim}
\begin{verbatim}
No events = 423:  Mean time between events for 2007 : 20:38:57.163120
\end{verbatim}
\begin{verbatim}
No events = 520:  Mean time between events for 2008 : 16:51:18.115384
\end{verbatim}
\begin{verbatim}
No events = 498:  Mean time between events for 2009 : 17:34:01.686746
\end{verbatim}
\begin{verbatim}
No events = 448:  Mean time between events for 2010 : 19:26:10.580357
\end{verbatim}
\begin{verbatim}
No events = 493:  Mean time between events for 2011 : 17:33:52.332657
\end{verbatim}
\begin{verbatim}
No events = 302:  Mean time between events for 2012 : 14:14:00.198675
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
x={}
#total outages per year
for year,yeardata in byyear:
    print year,len(yeardata.Flt_Item)
    x[year] = len(yeardata.Flt_Item)
total_outages=Series(x)
total_outages[1:].plot(kind='bar',title='Total recored forced outages per year (all types)')
event_outages = DataFrame({'events':total_events[1:],'outages':total_outages[1:]})

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
1999 260
2000 625
2001 735
2002 738
2003 554
2004 662
2005 649
2006 1011
2007 674
2008 786
2009 877
2010 750
2011 847
2012 478
\end{verbatim}
\begin{center}
\includegraphics[width=6in]{forced_outages-svg_files/forced_outages-svg_fig_03.pdf}
\par
\end{center}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
plt.figure(1,figsize=[20,20]);
event_outages.plot(kind='bar',figsize=[20,20])


\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<matplotlib.axes.AxesSubplot at 0x559ec50>
\end{verbatim}
\end{codeoutput}
\end{codecell}
Ok, fit a straight line (using a simple ordinary least squares model)
and output some statistics on annual events

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
import statsmodels.api as sm
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
X = np.array(event_outages.outages.index.tolist())
X = sm.add_constant(X)
results_outages = sm.OLS(event_outages.outages, X).fit()
results_events = sm.OLS(event_outages.events, X).fit()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
/usr/local/lib/python2.7/dist-packages/statsmodels-0.5.0-py2.7-linux-x86_64.egg/statsmodels/tools/tools.py:306: FutureWarning: The default of `prepend` will be changed to True in 0.5.0, use explicit prepend
  FutureWarning)
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
X
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
array([[ 1.,  1.],
       [ 2.,  1.],
       [ 3.,  1.],
       [ 4.,  1.],
       [ 5.,  1.],
       [ 6.,  1.],
       [ 7.,  1.]])
\end{verbatim}
\end{codeoutput}
\end{codecell}


\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
event_outages.outages.plot()
(results_outages.fittedvalues).plot(style='r')
event_outages.events.plot()
(results_events.fittedvalues).plot(style='r')

\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<matplotlib.axes.AxesSubplot at 0x77c99d0>
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
results_events.summary()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
/usr/lib/python2.7/dist-packages/scipy/stats/stats.py:1198: UserWarning: kurtosistest only valid for n>=20 ... continuing anyway, n=12
  int(n))
\end{verbatim}
\begin{verbatim}
<class 'statsmodels.iolib.summary.Summary'>
"""
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 events   R-squared:                       0.059
Model:                            OLS   Adj. R-squared:                 -0.035
Method:                 Least Squares   F-statistic:                    0.6260
Date:                Wed, 03 Oct 2012   Prob (F-statistic):              0.447
Time:                        11:29:25   Log-Likelihood:                -64.751
No. Observations:                  12   AIC:                             133.5
Df Residuals:                      10   BIC:                             134.5
Df Model:                           1                                         
==============================================================================
                 coef    std err          t      P>|t|      [95.0% Conf. Int.]
------------------------------------------------------------------------------
x1             3.8671      4.887      0.791      0.447        -7.023    14.757
const      -7284.3683   9801.866     -0.743      0.474     -2.91e+04  1.46e+04
==============================================================================
Omnibus:                        1.075   Durbin-Watson:                   2.524
Prob(Omnibus):                  0.584   Jarque-Bera (JB):                0.734
Skew:                           0.551   Prob(JB):                        0.693
Kurtosis:                       2.496   Cond. No.                     1.17e+06
==============================================================================

The condition number is large, 1.17e+06. This might indicate that there are
strong multicollinearity or other numerical problems.
"""
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
results_outages.summary()
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<class 'statsmodels.iolib.summary.Summary'>
"""
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                outages   R-squared:                       0.265
Model:                            OLS   Adj. R-squared:                  0.191
Method:                 Least Squares   F-statistic:                     3.598
Date:                Wed, 03 Oct 2012   Prob (F-statistic):             0.0871
Time:                        11:29:41   Log-Likelihood:                -72.618
No. Observations:                  12   AIC:                             149.2
Df Residuals:                      10   BIC:                             150.2
Df Model:                           1                                         
==============================================================================
                 coef    std err          t      P>|t|      [95.0% Conf. Int.]
------------------------------------------------------------------------------
x1            17.8601      9.415      1.897      0.087        -3.118    38.839
const      -3.508e+04   1.89e+04     -1.858      0.093     -7.71e+04  6996.361
==============================================================================
Omnibus:                        5.945   Durbin-Watson:                   2.716
Prob(Omnibus):                  0.051   Jarque-Bera (JB):                2.550
Skew:                           1.037   Prob(JB):                        0.279
Kurtosis:                       3.893   Cond. No.                     1.17e+06
==============================================================================

The condition number is large, 1.17e+06. This might indicate that there are
strong multicollinearity or other numerical problems.
"""
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
\sum_i
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
Y = [1,3,4,5,2,3,4]
X = range(1,8)
X = sm.add_constant(X)
model = sm.OLS(Y,X)
results = model.fit()
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
plot(X[:,0],Y)
plot(X[:,0],results.fittedvalues,'r')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
[<matplotlib.lines.Line2D at 0x6f6c5d0>]
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
(event_outages['outages']/event_outages['events'].map(lambda x: float(x))).plot(kind='bar')
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
<matplotlib.axes.AxesSubplot at 0x77c99d0>
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
X[:,0]
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.])
\end{verbatim}
\end{codeoutput}
\end{codecell}

\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
a=sum(x.diff().tolist()[1:])/(len(xx)-1)
\end{lstlisting}
\end{codeinput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
print a
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{verbatim}
17:31:44.331983
\end{verbatim}
\end{codeoutput}
\end{codecell}
\begin{codecell}
\begin{codeinput}
\begin{lstlisting}
sum(x.diff().tolist(), timedelta()) / len(x.diff())
\end{lstlisting}
\end{codeinput}
\begin{codeoutput}
\begin{traceback}
\begin{verbatim}
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-152-bacfac4eadc2> in <module>()
----> 1 sum(x.diff().tolist(), timedelta()) / len(x.diff())

/usr/lib/python2.7/dist-packages/numpy/core/fromnumeric.pyc in sum(a, axis, dtype, out)
   1452         sum = a.sum
   1453     except AttributeError:
-> 1454         return _wrapit(a, 'sum', axis, dtype, out)
   1455     return sum(axis, dtype, out)
   1456 

/usr/lib/python2.7/dist-packages/numpy/core/fromnumeric.pyc in _wrapit(obj, method, *args, **kwds)
     35     except AttributeError:
     36         wrap = None
---> 37     result = getattr(asarray(obj),method)(*args, **kwds)
     38     if wrap:
     39         if not isinstance(result, mu.ndarray):

TypeError: an integer is required
\end{verbatim}
\end{traceback}
\end{codeoutput}
\end{codecell}

\end{document}
